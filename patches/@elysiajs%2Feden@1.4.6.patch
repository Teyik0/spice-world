diff --git a/node_modules/@elysiajs/eden/dist/chunk-3RD5JO62.mjs b/dist/chunk-3RD5JO62.mjs
new file mode 100644
index 0000000000000000000000000000000000000000..e1b3b665cde6edbfc944a3324a6c7bb675b7f924
--- /dev/null
+++ b/dist/chunk-3RD5JO62.mjs
@@ -0,0 +1,4 @@
+import{a as R,b as M,c as C,d as q}from"./chunk-QSLHAOSM.mjs";var K=class{constructor(s){this.url=s;this.ws=new WebSocket(s)}ws;send(s){return Array.isArray(s)?(s.forEach(e=>this.send(e)),this):(this.ws.send(typeof s=="object"?JSON.stringify(s):s.toString()),this)}on(s,e,n){return this.addEventListener(s,e,n)}off(s,e,n){return this.ws.removeEventListener(s,e,n),this}subscribe(s,e){return this.addEventListener("message",s,e)}addEventListener(s,e,n){return this.ws.addEventListener(s,r=>{if(s==="message"){let i=q(r);e({...r,data:i})}else e(r)},n),this}removeEventListener(s,e,n){return this.off(s,e,n),this}close(){return this.ws.close(),this}};var _=["get","post","put","delete","patch","options","head","connect","subscribe"],I=["localhost","127.0.0.1","0.0.0.0"],L=typeof FileList>"u",k=t=>L?t instanceof Blob:t instanceof FileList||t instanceof File,A=t=>{if(!t)return!1;for(let s in t){let e=t[s];if(k(e))return!0;if(Array.isArray(e)){for(let n of e)if(k(n)||typeof n=="object"&&n!==null&&A(n))return!0}else if(typeof e=="object"&&e!==null&&!(e instanceof Date)&&A(e))return!0}return!1},N=(t,s)=>{let e={},n=[];for(let[r,i]of Object.entries(t))if(k(i))n.push({key:`${s}.${r}`,value:i});else if(Array.isArray(i))if(i.some(o=>k(o)||typeof o=="object"&&o!==null&&A(o)))for(let o=0;o<i.length;o++){let l=i[o];if(k(l))n.push({key:`${s}.${r}[${o}]`,value:l});else if(typeof l=="object"&&l!==null&&A(l)){let y=N(l,`${s}.${r}[${o}]`);Object.keys(y.nonFileData).length>0&&n.push({key:`${s}.${r}[${o}]`,value:JSON.stringify(y.nonFileData)}),n.push(...y.files)}else typeof l=="object"&&l!==null?n.push({key:`${s}.${r}[${o}]`,value:JSON.stringify(l)}):n.push({key:`${s}.${r}[${o}]`,value:l})}else e[r]=i;else if(typeof i=="object"&&i!==null&&!(i instanceof Date))if(A(i)){let a=N(i,`${s}.${r}`);Object.keys(a.nonFileData).length>0&&(e[r]=a.nonFileData),n.push(...a.files)}else e[r]=i;else e[r]=i;return{nonFileData:e,files:n}},P=(t,s="")=>{let e={};for(let[n,r]of Object.entries(t)){let i=s?`${s}.${n}`:n;if(k(r))e[i]=r;else if(Array.isArray(r))if(r.some(o=>k(o)||typeof o=="object"&&o!==null&&A(o)))if(r.every(l=>k(l)))for(let l=0;l<r.length;l++)e[`${i}[${l}]`]=r[l];else for(let l=0;l<r.length;l++){let y=r[l],p=`${i}[${l}]`;if(k(y))e[p]=y;else if(typeof y=="object"&&y!==null&&!(y instanceof Date))if(A(y)){let{nonFileData:x,files:O}=N(y,p);Object.keys(x).length>0&&(e[p]=JSON.stringify(x));for(let{key:v,value:E}of O)e[v]=E}else e[p]=JSON.stringify(y);else e[p]=y}else e[i]=JSON.stringify(r);else typeof r=="object"&&r!==null&&!(r instanceof Date)?A(r)?Object.assign(e,P(r,i)):e[i]=JSON.stringify(r):e[i]=r}return e},T=t=>L?t:new Promise(s=>{let e=new FileReader;e.onload=()=>{let n=new File([e.result],t.name,{lastModified:t.lastModified,type:t.type});s(n)},e.readAsArrayBuffer(t)}),j=async(t,s,e={},n={})=>{if(Array.isArray(t)){for(let r of t)if(!Array.isArray(r))n=await j(r,s,e,n);else{let i=r[0];if(typeof i=="string")n[i.toLowerCase()]=r[1];else for(let[a,o]of i)n[a.toLowerCase()]=o}return n}if(!t)return n;switch(typeof t){case"function":if(t instanceof Headers)return j(t,s,e,n);let r=await t(s,e);return r?j(r,s,e,n):n;case"object":if(t instanceof Headers)return t.forEach((i,a)=>{n[a.toLowerCase()]=i}),n;for(let[i,a]of Object.entries(t))n[i.toLowerCase()]=a;return n;default:return n}};function B(t){let s=t.split(`
+`),e={};for(let n of s){if(!n||n.startsWith(":"))continue;let r=n.indexOf(":");if(r>0){let i=n.slice(0,r).trim(),a=n.slice(r+1).replace(/^ /,"");e[i]=a&&C(a)}}return Object.keys(e).length>0?e:null}function*H(t){let s;for(;(s=t.value.indexOf(`
+
+`))!==-1;){let e=t.value.slice(0,s);if(t.value=t.value.slice(s+2),e.trim()){let n=B(e);n&&(yield n)}}}async function*G(t){let s=t.body;if(!s)return;let e=s.getReader(),n=new TextDecoder("utf-8"),r={value:""};try{for(;;){let{done:a,value:o}=await e.read();if(a)break;let l=typeof o=="string"?o:n.decode(o,{stream:!0});r.value+=l,yield*H(r)}let i=n.decode();if(i&&(r.value+=i),yield*H(r),r.value.trim()){let a=B(r.value);a&&(yield a)}}finally{e.releaseLock()}}var D=(t,s,e=[],n)=>new Proxy(()=>{},{get(r,i){return D(t,s,i==="index"?e:[...e,i],n)},apply(r,i,[a,o]){if(!a||o||typeof a=="object"&&Object.keys(a).length!==1||_.includes(e.at(-1))){let l=[...e],y=l.pop(),p="/"+l.join("/"),{fetcher:x=fetch,headers:O,onRequest:v,onResponse:E,fetch:U}=s,F=y==="get"||y==="head"||y==="subscribe",J=F?a?.query:o?.query,W="";if(J){let c=(m,b)=>{W+=(W?"&":"?")+`${encodeURIComponent(m)}=${encodeURIComponent(b)}`};for(let[m,b]of Object.entries(J)){if(Array.isArray(b)){for(let u of b)c(m,u);continue}if(b!=null){if(typeof b=="object"){c(m,JSON.stringify(b));continue}c(m,`${b}`)}}}if(y==="subscribe"){let c=t.replace(/^([^]+):\/\//,t.startsWith("https://")?"wss://":t.startsWith("http://")||I.find(m=>t.includes(m))?"ws://":"wss://")+p+W;return new K(c)}return(async()=>{O=await j(O,p,o);let c={method:y?.toUpperCase(),body:a,...U,headers:O};c.headers={...O,...await j(F?a?.headers:o?.headers,p,c)};let m=F&&typeof a=="object"?a.fetch:o?.fetch;if(c={...c,...m},F&&delete c.body,v){Array.isArray(v)||(v=[v]);for(let d of v){let f=await d(p,c);typeof f=="object"&&(c={...c,...f,headers:{...c.headers,...await j(f.headers,p,c)}})}}if(F&&delete c.body,A(a)){let d=new FormData,f=P(c.body);for(let[h,g]of Object.entries(f))if(Array.isArray(g))for(let S of g)S instanceof File?d.append(h,L?S:await T(S)):k(S)&&d.append(h,S);else if(g instanceof File)d.append(h,L?g:await T(g));else if(!L&&g instanceof FileList)for(let S=0;S<g.length;S++)d.append(h,await T(g[S]));else k(g),d.append(h,g);c.body=d}else typeof a=="object"?(c.headers["content-type"]="application/json",c.body=JSON.stringify(a)):a!=null&&(c.headers["content-type"]="text/plain");if(F&&delete c.body,v){Array.isArray(v)||(v=[v]);for(let d of v){let f=await d(p,c);typeof f=="object"&&(c={...c,...f,headers:{...c.headers,...await j(f.headers,p,c)}})}}o?.headers?.["content-type"]&&(c.headers["content-type"]=o?.headers["content-type"]);let b=t+p+W,u;try{u=await(n?.handle(new Request(b,c))??x(b,c))}catch(d){return{data:null,error:new R(503,d),response:void 0,status:503,headers:void 0}}let w=null,$=null;if(E){Array.isArray(E)||(E=[E]);for(let d of E)try{let f=await d(u.clone());if(f!=null){w=f;break}}catch(f){f instanceof R?$=f:$=new R(422,f);break}}if(w!==null)return{data:w,error:$,response:u,status:u.status,headers:u.headers};switch(u.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":w=G(u);break;case"application/json":w=JSON.parse(await u.text(),(f,h)=>{if(typeof h!="string")return h;let g=M(h);return g||h});break;case"application/octet-stream":w=await u.arrayBuffer();break;case"multipart/form-data":let d=await u.formData();w={},d.forEach((f,h)=>{w[h]=f});break;default:w=await u.text().then(C)}return(u.status>=300||u.status<200)&&($=new R(u.status,w),w=null),{data:w,error:$,response:u,status:u.status,headers:u.headers}})()}return typeof a=="object"?D(t,s,[...e,Object.values(a)[0]],n):D(t,s,e)}}),Z=(t,s={})=>typeof t=="string"?(s.keepDomain||(t.includes("://")||(t=(I.find(e=>t.includes(e))?"http://":"https://")+t),t.endsWith("/")&&(t=t.slice(0,-1))),D(t,s)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),D("http://e.ly",s,[],t));export{G as a,Z as b};
diff --git a/dist/chunk-7WR4DS5F.mjs b/Users/teyik0/.bun/install/cache/@elysiajs/eden@1.4.6@@@1/dist/chunk-7WR4DS5F.mjs
deleted file mode 100644
index 9824adab1675f2f67acc8b653486e50310d45fe6..0000000000000000000000000000000000000000
diff --git a/dist/chunk-EF6Z4LSD.mjs b/Users/teyik0/.bun/install/cache/@elysiajs/eden@1.4.6@@@1/dist/chunk-EF6Z4LSD.mjs
deleted file mode 100644
index d74bf3736efc187e0e5c5452cb48e2eb83e3929c..0000000000000000000000000000000000000000
diff --git a/node_modules/@elysiajs/eden/dist/chunk-F3GV6FPC.mjs b/dist/chunk-F3GV6FPC.mjs
new file mode 100644
index 0000000000000000000000000000000000000000..1da4f40d03cadd97bfc6359f6bf840cf14e86c01
--- /dev/null
+++ b/dist/chunk-F3GV6FPC.mjs
@@ -0,0 +1 @@
+import{a as M,c as P,d as N}from"./chunk-QSLHAOSM.mjs";var I=(a,t,e)=>{if(a.endsWith("/")||(a+="/"),t==="index"&&(t=""),!e||!Object.keys(e).length)return`${a}${t}`;let s="";for(let[n,r]of Object.entries(e))s+=`${n}=${r}&`;return`${a}${t}?${s.slice(0,-1)}`};var S=typeof FileList>"u",y=a=>S?a instanceof Blob:a instanceof FileList||a instanceof File,h=a=>{if(!a)return!1;for(let t in a){let e=a[t];if(y(e))return!0;if(Array.isArray(e)){for(let s of e)if(y(s)||typeof s=="object"&&s!==null&&h(s))return!0}if(typeof e=="object"&&e!==null&&!(e instanceof Date)&&h(e))return!0}return!1},K=(a,t)=>{let e={},s=[];for(let[n,r]of Object.entries(a))if(y(r))s.push({key:`${t}.${n}`,value:r});else if(Array.isArray(r))if(r.some(i=>y(i)||typeof i=="object"&&i!==null&&h(i)))for(let i=0;i<r.length;i++){let o=r[i];if(y(o))s.push({key:`${t}.${n}`,value:o});else if(typeof o=="object"&&o!==null&&h(o)){let f=K(o,`${t}.${n}[${i}]`);Object.keys(f.nonFileData).length>0&&s.push({key:`${t}.${n}[${i}]`,value:JSON.stringify(f.nonFileData)}),s.push(...f.files)}else typeof o=="object"&&o!==null?s.push({key:`${t}.${n}[${i}]`,value:JSON.stringify(o)}):s.push({key:`${t}.${n}[${i}]`,value:o})}else e[n]=r;else if(typeof r=="object"&&r!==null&&!(r instanceof Date))if(h(r)){let d=K(r,`${t}.${n}`);Object.keys(d.nonFileData).length>0&&(e[n]=d.nonFileData),s.push(...d.files)}else e[n]=r;else e[n]=r;return{nonFileData:e,files:s}},J=(a,t="")=>{let e={};for(let[s,n]of Object.entries(a)){let r=t?`${t}.${s}`:s;if(y(n))e[r]=n;else if(Array.isArray(n))if(n.some(i=>y(i)||typeof i=="object"&&i!==null&&h(i)))if(n.every(o=>y(o)))e[r]=n;else for(let o=0;o<n.length;o++){let f=n[o],g=`${r}[${o}]`;if(y(f))e[g]=f;else if(typeof f=="object"&&f!==null&&!(f instanceof Date))if(h(f)){let{nonFileData:b,files:O}=K(f,g);Object.keys(b).length>0&&(e[g]=JSON.stringify(b));for(let{key:j,value:k}of O)e[j]=k}else e[g]=JSON.stringify(f);else e[g]=f}else e[r]=JSON.stringify(n);else typeof n=="object"&&n!==null&&!(n instanceof Date)?h(n)?Object.assign(e,J(n,r)):e[r]=JSON.stringify(n):e[r]=n}return e},D=a=>S?a:new Promise(t=>{let e=new FileReader;e.onload=()=>{let s=new File([e.result],a.name,{lastModified:a.lastModified,type:a.type});t(s)},e.readAsArrayBuffer(a)}),L=class{ws;url;constructor(t){this.ws=new WebSocket(t),this.url=t}send(t){return Array.isArray(t)?(t.forEach(e=>this.send(e)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,e,s){return this.addEventListener(t,e,s)}off(t,e,s){return this.ws.removeEventListener(t,e,s),this}subscribe(t,e){return this.addEventListener("message",t,e)}addEventListener(t,e,s){return this.ws.addEventListener(t,n=>{if(t==="message"){let r=N(n);e({...n,data:r})}else e(n)},s),this}removeEventListener(t,e,s){return this.off(t,e,s),this}close(){return this.ws.close(),this}},C=(a,t="",e)=>new Proxy(()=>{},{get(s,n,r){return C(a,`${t}/${n.toString()}`,e)},apply(s,n,[r,d={}]=[{},{}]){let i=r!==void 0&&(typeof r!="object"||Array.isArray(r))?r:void 0,{$query:o,$fetch:f,$headers:g,$transform:b,getRaw:O,...j}=r??{};i??=j;let k=t.lastIndexOf("/"),w=t.slice(k+1).toUpperCase(),R=I(a,k===-1?"/":t.slice(0,k),Object.assign(d.query??{},o)),H=e.fetcher??fetch,v=e.transform?Array.isArray(e.transform)?e.transform:[e.transform]:void 0,T=b?Array.isArray(b)?b:[b]:void 0;return T&&(v?v=T.concat(v):v=T),w==="SUBSCRIBE"?new L(R.replace(/^([^]+):\/\//,R.startsWith("https://")?"wss://":"ws://")):(async q=>{let c,W={...e.$fetch?.headers,...f?.headers,...d.headers,...g};if(w!=="GET"&&w!=="HEAD"){c=Object.keys(i).length||Array.isArray(i)?i:void 0;let A=c&&(typeof c=="object"||Array.isArray(i));if(A&&h(c)){let E=new FormData,U=J(c);for(let[$,l]of Object.entries(U))if(Array.isArray(l))for(let p of l)p instanceof File?E.append($,S?p:await D(p)):y(p)&&E.append($,p);else if(l instanceof File)E.append($,S?l:await D(l));else if(!S&&l instanceof FileList)for(let p=0;p<l.length;p++)E.append($,await D(l[p]));else y(l),E.append($,l);c=E}else c!=null&&(W["content-type"]=A?"application/json":"text/plain",c=A?JSON.stringify(c):i)}let u=await H(R,{method:w,body:c,...e.$fetch,...d.fetch,...f,headers:W}),F;if(q.getRaw)return u;u.headers.get("Content-Type")?.split(";")[0]==="application/json"?F=await u.json():F=await u.text().then(P);let B=u.status>=300||u.status<200?new M(u.status,F):null,x={data:F,error:B,response:u,status:u.status,headers:u.headers};if(v)for(let A of v){let m=A(x);m instanceof Promise&&(m=await m),m!=null&&(x=m)}return x})({getRaw:O})}}),X=(a,t={fetcher:fetch})=>new Proxy({},{get(e,s){return C(a,s,t)}});export{L as a,X as b};
diff --git a/dist/index.global.js b/dist/index.global.js
index bf4c1fefee248acd508f86de0bc12851354f5cf9..4d7680d12b265d692394f0ec365b4bb02c708ce8 100644
--- a/dist/index.global.js
+++ b/dist/index.global.js
@@ -1,4 +1,4 @@
-"use strict";var Eden=(()=>{var U=Object.defineProperty;var se=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var ie=Object.prototype.hasOwnProperty;var oe=(e,t)=>{for(var n in t)U(e,n,{get:t[n],enumerable:!0})},ce=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of ae(t))!ie.call(e,s)&&s!==n&&U(e,s,{get:()=>t[s],enumerable:!(r=se(t,s))||r.enumerable});return e};var fe=e=>ce(U({},"__esModule",{value:!0}),e);var ke={};oe(ke,{EdenFetchError:()=>S,edenFetch:()=>re,edenTreaty:()=>ne,treaty:()=>X});var S=class extends Error{constructor(n,r){super(r+"");this.status=n;this.value=r}};var de=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,ue=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,ye=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,le=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),D=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(de.test(t)||ue.test(t)||ye.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},pe=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},he=e=>JSON.parse(e,(t,n)=>{let r=D(n);return r||n}),$=e=>{if(!e)return e;if(le(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=D(e);if(t)return t;if(pe(e))try{return he(e)}catch{}return e},I=e=>{let t=e.data.toString();return t==="null"?null:$(t)};var P=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,s=>{if(t==="message"){let i=I(s);n({...s,data:i})}else n(s)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}};var ge=["get","post","put","delete","patch","options","head","connect","subscribe"],Q=["localhost","127.0.0.1","0.0.0.0"],V=typeof FileList>"u",q=e=>V?e instanceof Blob:e instanceof FileList||e instanceof File,me=e=>{if(!e)return!1;for(let t in e)if(q(e[t])||Array.isArray(e[t])&&e[t].find(q))return!0;return!1},B=e=>V?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),C=async(e,t,n={},r={})=>{if(Array.isArray(e)){for(let s of e)if(!Array.isArray(s))r=await C(s,t,n,r);else{let i=s[0];if(typeof i=="string")r[i.toLowerCase()]=s[1];else for(let[a,d]of i)r[a.toLowerCase()]=d}return r}if(!e)return r;switch(typeof e){case"function":if(e instanceof Headers)return C(e,t,n,r);let s=await e(t,n);return s?C(s,t,n,r):r;case"object":if(e instanceof Headers)return e.forEach((i,a)=>{r[a.toLowerCase()]=i}),r;for(let[i,a]of Object.entries(e))r[i.toLowerCase()]=a;return r;default:return r}};function z(e){let t=e.split(`
-`),n={};for(let r of t){if(!r||r.startsWith(":"))continue;let s=r.indexOf(":");if(s>0){let i=r.slice(0,s).trim(),a=r.slice(s+1).replace(/^ /,"");n[i]=a&&$(a)}}return Object.keys(n).length>0?n:null}function*Z(e){let t;for(;(t=e.value.indexOf(`
+"use strict";var Eden=(()=>{var _=Object.defineProperty;var le=Object.getOwnPropertyDescriptor;var ye=Object.getOwnPropertyNames;var ue=Object.prototype.hasOwnProperty;var de=(t,n)=>{for(var e in n)_(t,e,{get:n[e],enumerable:!0})},pe=(t,n,e,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of ye(n))!ue.call(t,r)&&r!==e&&_(t,r,{get:()=>n[r],enumerable:!(s=le(n,r))||s.enumerable});return t};var he=t=>pe(_({},"__esModule",{value:!0}),t);var Fe={};de(Fe,{EdenFetchError:()=>O,edenFetch:()=>ce,edenTreaty:()=>oe,treaty:()=>se});var O=class extends Error{constructor(e,s){super(s+"");this.status=e;this.value=s}};var ge=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,be=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,me=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,we=t=>t.trim().length!==0&&!Number.isNaN(Number(t)),U=t=>{if(typeof t!="string")return null;let n=t.replace(/"/g,"");if(ge.test(n)||be.test(n)||me.test(n)){let e=new Date(n);if(!Number.isNaN(e.getTime()))return e}return null},ve=t=>{let n=t.charCodeAt(0),e=t.charCodeAt(t.length-1);return n===123&&e===125||n===91&&e===93},Se=t=>JSON.parse(t,(n,e)=>{let s=U(e);return s||e}),K=t=>{if(!t)return t;if(we(t))return+t;if(t==="true")return!0;if(t==="false")return!1;let n=U(t);if(n)return n;if(ve(t))try{return Se(t)}catch{}return t},B=t=>{let n=t.data.toString();return n==="null"?null:K(n)};var V=class{constructor(n){this.url=n;this.ws=new WebSocket(n)}ws;send(n){return Array.isArray(n)?(n.forEach(e=>this.send(e)),this):(this.ws.send(typeof n=="object"?JSON.stringify(n):n.toString()),this)}on(n,e,s){return this.addEventListener(n,e,s)}off(n,e,s){return this.ws.removeEventListener(n,e,s),this}subscribe(n,e){return this.addEventListener("message",n,e)}addEventListener(n,e,s){return this.ws.addEventListener(n,r=>{if(n==="message"){let a=B(r);e({...r,data:a})}else e(r)},s),this}removeEventListener(n,e,s){return this.off(n,e,s),this}close(){return this.ws.close(),this}};var Ee=["get","post","put","delete","patch","options","head","connect","subscribe"],ee=["localhost","127.0.0.1","0.0.0.0"],P=typeof FileList>"u",R=t=>P?t instanceof Blob:t instanceof FileList||t instanceof File,N=t=>{if(!t)return!1;for(let n in t){let e=t[n];if(R(e))return!0;if(Array.isArray(e)){for(let s of e)if(R(s)||typeof s=="object"&&s!==null&&N(s))return!0}else if(typeof e=="object"&&e!==null&&!(e instanceof Date)&&N(e))return!0}return!1},Z=(t,n)=>{let e={},s=[];for(let[r,a]of Object.entries(t))if(R(a))s.push({key:`${n}.${r}`,value:a});else if(Array.isArray(a))if(a.some(i=>R(i)||typeof i=="object"&&i!==null&&N(i)))for(let i=0;i<a.length;i++){let c=a[i];if(R(c))s.push({key:`${n}.${r}[${i}]`,value:c});else if(typeof c=="object"&&c!==null&&N(c)){let f=Z(c,`${n}.${r}[${i}]`);Object.keys(f.nonFileData).length>0&&s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(f.nonFileData)}),s.push(...f.files)}else typeof c=="object"&&c!==null?s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(c)}):s.push({key:`${n}.${r}[${i}]`,value:c})}else e[r]=a;else if(typeof a=="object"&&a!==null&&!(a instanceof Date))if(N(a)){let o=Z(a,`${n}.${r}`);Object.keys(o.nonFileData).length>0&&(e[r]=o.nonFileData),s.push(...o.files)}else e[r]=a;else e[r]=a;return{nonFileData:e,files:s}},te=(t,n="")=>{let e={};for(let[s,r]of Object.entries(t)){let a=n?`${n}.${s}`:s;if(R(r))e[a]=r;else if(Array.isArray(r))if(r.some(i=>R(i)||typeof i=="object"&&i!==null&&N(i)))if(r.every(c=>R(c)))for(let c=0;c<r.length;c++)e[`${a}[${c}]`]=r[c];else for(let c=0;c<r.length;c++){let f=r[c],u=`${a}[${c}]`;if(R(f))e[u]=f;else if(typeof f=="object"&&f!==null&&!(f instanceof Date))if(N(f)){let{nonFileData:v,files:A}=Z(f,u);Object.keys(v).length>0&&(e[u]=JSON.stringify(v));for(let{key:g,value:b}of A)e[g]=b}else e[u]=JSON.stringify(f);else e[u]=f}else e[a]=JSON.stringify(r);else typeof r=="object"&&r!==null&&!(r instanceof Date)?N(r)?Object.assign(e,te(r,a)):e[a]=JSON.stringify(r):e[a]=r}return e},G=t=>P?t:new Promise(n=>{let e=new FileReader;e.onload=()=>{let s=new File([e.result],t.name,{lastModified:t.lastModified,type:t.type});n(s)},e.readAsArrayBuffer(t)}),C=async(t,n,e={},s={})=>{if(Array.isArray(t)){for(let r of t)if(!Array.isArray(r))s=await C(r,n,e,s);else{let a=r[0];if(typeof a=="string")s[a.toLowerCase()]=r[1];else for(let[o,i]of a)s[o.toLowerCase()]=i}return s}if(!t)return s;switch(typeof t){case"function":if(t instanceof Headers)return C(t,n,e,s);let r=await t(n,e);return r?C(r,n,e,s):s;case"object":if(t instanceof Headers)return t.forEach((a,o)=>{s[o.toLowerCase()]=a}),s;for(let[a,o]of Object.entries(t))s[a.toLowerCase()]=o;return s;default:return s}};function ne(t){let n=t.split(`
+`),e={};for(let s of n){if(!s||s.startsWith(":"))continue;let r=s.indexOf(":");if(r>0){let a=s.slice(0,r).trim(),o=s.slice(r+1).replace(/^ /,"");e[a]=o&&K(o)}}return Object.keys(e).length>0?e:null}function*Y(t){let n;for(;(n=t.value.indexOf(`
 
-`))!==-1;){let n=e.value.slice(0,t);if(e.value=e.value.slice(t+2),n.trim()){let r=z(n);r&&(yield r)}}}async function*we(e){let t=e.body;if(!t)return;let n=t.getReader(),r=new TextDecoder("utf-8"),s={value:""};try{for(;;){let{done:a,value:d}=await n.read();if(a)break;let W=typeof d=="string"?d:r.decode(d,{stream:!0});s.value+=W,yield*Z(s)}let i=r.decode();if(i&&(s.value+=i),yield*Z(s),s.value.trim()){let a=z(s.value);a&&(yield a)}}finally{n.releaseLock()}}var K=(e,t,n=[],r)=>new Proxy(()=>{},{get(s,i){return K(e,t,i==="index"?n:[...n,i],r)},apply(s,i,[a,d]){if(!a||d||typeof a=="object"&&Object.keys(a).length!==1||ge.includes(n.at(-1))){let W=[...n],F=W.pop(),A="/"+W.join("/"),{fetcher:R=fetch,headers:j,onRequest:w,onResponse:k,fetch:E}=t,h=F==="get"||F==="head"||F==="subscribe",N=h?a?.query:d?.query,O="";if(N){let o=(L,b)=>{O+=(O?"&":"?")+`${encodeURIComponent(L)}=${encodeURIComponent(b)}`};for(let[L,b]of Object.entries(N)){if(Array.isArray(b)){for(let c of b)o(L,c);continue}if(b!=null){if(typeof b=="object"){o(L,JSON.stringify(b));continue}o(L,`${b}`)}}}if(F==="subscribe"){let o=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||Q.find(L=>e.includes(L))?"ws://":"wss://")+A+O;return new P(o)}return(async()=>{j=await C(j,A,d);let o={method:F?.toUpperCase(),body:a,...E,headers:j};o.headers={...j,...await C(h?a?.headers:d?.headers,A,o)};let L=h&&typeof a=="object"?a.fetch:d?.fetch;if(o={...o,...L},h&&delete o.body,w){Array.isArray(w)||(w=[w]);for(let u of w){let y=await u(A,o);typeof y=="object"&&(o={...o,...y,headers:{...o.headers,...await C(y.headers,A,o)}})}}if(h&&delete o.body,me(a)){let u=new FormData,y=f=>{if(typeof f=="string"||q(f))return!1;if(typeof f=="object"){if(f!==null)return!0;if(f instanceof Date)return!1}return!1},m=async f=>f instanceof File?await B(f):y(f)?JSON.stringify(f):f;for(let[f,l]of Object.entries(o.body)){if(Array.isArray(l)){if(l.some(v=>typeof v=="object"&&v!==null&&!q(v)))u.append(f,JSON.stringify(l));else for(let v=0;v<l.length;v++){let T=l[v],M=await m(T);u.append(f,M)}continue}if(V){if(Array.isArray(l))for(let x of l)u.append(f,await m(x));else u.append(f,await m(l));continue}if(l instanceof File){u.append(f,await B(l));continue}if(l instanceof FileList){for(let x=0;x<l.length;x++)u.append(f,await B(l[x]));continue}u.append(f,await m(l))}o.body=u}else typeof a=="object"?(o.headers["content-type"]="application/json",o.body=JSON.stringify(a)):a!=null&&(o.headers["content-type"]="text/plain");if(h&&delete o.body,w){Array.isArray(w)||(w=[w]);for(let u of w){let y=await u(A,o);typeof y=="object"&&(o={...o,...y,headers:{...o.headers,...await C(y.headers,A,o)}})}}d?.headers?.["content-type"]&&(o.headers["content-type"]=d?.headers["content-type"]);let b=e+A+O,c;try{c=await(r?.handle(new Request(b,o))??R(b,o))}catch(u){return{data:null,error:new S(503,u),response:void 0,status:503,headers:void 0}}let g=null,p=null;if(k){Array.isArray(k)||(k=[k]);for(let u of k)try{let y=await u(c.clone());if(y!=null){g=y;break}}catch(y){y instanceof S?p=y:p=new S(422,y);break}}if(g!==null)return{data:g,error:p,response:c,status:c.status,headers:c.headers};switch(c.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":g=we(c);break;case"application/json":g=JSON.parse(await c.text(),(y,m)=>{if(typeof m!="string")return m;let f=D(m);return f||m});break;case"application/octet-stream":g=await c.arrayBuffer();break;case"multipart/form-data":let u=await c.formData();g={},u.forEach((y,m)=>{g[m]=y});break;default:g=await c.text().then($)}return(c.status>=300||c.status<200)&&(p=new S(c.status,g),g=null),{data:g,error:p,response:c,status:c.status,headers:c.headers}})()}return typeof a=="object"?K(e,t,[...n,Object.values(a)[0]],r):K(e,t,n)}}),X=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(Q.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),K(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),K("http://e.ly",t,[],e));var Y=(e,t,n)=>{if(e.endsWith("/")||(e+="/"),t==="index"&&(t=""),!n||!Object.keys(n).length)return`${e}${t}`;let r="";for(let[s,i]of Object.entries(n))r+=`${s}=${i}&`;return`${e}${t}?${r.slice(0,-1)}`};var G=typeof FileList>"u",ee=e=>G?e instanceof Blob:e instanceof FileList||e instanceof File,Ee=e=>{if(!e)return!1;for(let t in e){if(ee(e[t]))return!0;if(Array.isArray(e[t])&&e[t].find(n=>ee(n)))return!0}return!1},H=e=>G?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),_=class{ws;url;constructor(t){this.ws=new WebSocket(t),this.url=t}send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,s=>{if(t==="message"){let i=I(s);n({...s,data:i})}else n(s)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}},te=(e,t="",n)=>new Proxy(()=>{},{get(r,s,i){return te(e,`${t}/${s.toString()}`,n)},apply(r,s,[i,a={}]=[{},{}]){let d=i!==void 0&&(typeof i!="object"||Array.isArray(i))?i:void 0,{$query:W,$fetch:F,$headers:A,$transform:R,getRaw:j,...w}=i??{};d??=w;let k=t.lastIndexOf("/"),E=t.slice(k+1).toUpperCase(),h=Y(e,k===-1?"/":t.slice(0,k),Object.assign(a.query??{},W)),N=n.fetcher??fetch,O=n.transform?Array.isArray(n.transform)?n.transform:[n.transform]:void 0,o=R?Array.isArray(R)?R:[R]:void 0;return o&&(O?O=o.concat(O):O=o),E==="SUBSCRIBE"?new _(h.replace(/^([^]+):\/\//,h.startsWith("https://")?"wss://":"ws://")):(async b=>{let c,g={...n.$fetch?.headers,...F?.headers,...a.headers,...A};if(E!=="GET"&&E!=="HEAD"){c=Object.keys(d).length||Array.isArray(d)?d:void 0;let f=c&&(typeof c=="object"||Array.isArray(d));if(f&&Ee(c)){let x=new FormData;for(let[v,T]of Object.entries(c))if(G)x.append(v,T);else if(T instanceof File)x.append(v,await H(T));else if(T instanceof FileList)for(let M=0;M<T.length;M++)x.append(v,await H(T[M]));else if(Array.isArray(T))for(let M=0;M<T.length;M++){let J=T[M];x.append(v,J instanceof File?await H(J):J)}else x.append(v,T);c=x}else c!=null&&(g["content-type"]=f?"application/json":"text/plain",c=f?JSON.stringify(c):d)}let p=await N(h,{method:E,body:c,...n.$fetch,...a.fetch,...F,headers:g}),u;if(b.getRaw)return p;switch(p.headers.get("Content-Type")?.split(";")[0]){case"application/json":u=await p.json();break;default:u=await p.text().then($)}let y=p.status>=300||p.status<200?new S(p.status,u):null,m={data:u,error:y,response:p,status:p.status,headers:p.headers};if(O)for(let f of O){let l=f(m);l instanceof Promise&&(l=await l),l!=null&&(m=l)}return m})({getRaw:j})}}),ne=(e,t={fetcher:fetch})=>new Proxy({},{get(n,r){return te(e,r,t)}});var be=async e=>{switch(e.headers.get("Content-Type")?.split(";")[0]){case"application/json":return e.json();case"application/octet-stream":return e.arrayBuffer();case"multipart/form-data":{let n=await e.formData(),r={};return n.forEach((s,i)=>{r[i]=s}),r}}return e.text().then($)},Se=async(e,t)=>{let n=await be(e);return e.status>300?{data:null,status:e.status,headers:e.headers,retry:t,error:new S(e.status,n)}:{data:n,error:null,status:e.status,headers:e.headers,retry:t}},re=(e,t)=>(n,{query:r,params:s,body:i,...a}={})=>{s&&Object.entries(s).forEach(([E,h])=>{n=n.replace(`:${E}`,h)});let d=t?.fetcher||globalThis.fetch,W=r?Object.fromEntries(Object.entries(r).filter(([E,h])=>h!=null)):null,F=W?`?${new URLSearchParams(W).toString()}`:"",A=`${e}${n}${F}`,R=new Headers(a.headers||{}),j=R.get("content-type");if(!(i instanceof FormData)&&!(i instanceof URLSearchParams)&&(!j||j==="application/json"))try{i=JSON.stringify(i),j||R.set("content-type","application/json")}catch{}let w={...a,method:a.method?.toUpperCase()||"GET",headers:R,body:i},k=()=>d(A,w).then(E=>Se(E,k)).catch(E=>({data:null,error:new S(503,E),status:503,headers:void 0,retry:k}));return k()};return fe(ke);})();
+`))!==-1;){let e=t.value.slice(0,n);if(t.value=t.value.slice(n+2),e.trim()){let s=ne(e);s&&(yield s)}}}async function*ke(t){let n=t.body;if(!n)return;let e=n.getReader(),s=new TextDecoder("utf-8"),r={value:""};try{for(;;){let{done:o,value:i}=await e.read();if(o)break;let c=typeof i=="string"?i:s.decode(i,{stream:!0});r.value+=c,yield*Y(r)}let a=s.decode();if(a&&(r.value+=a),yield*Y(r),r.value.trim()){let o=ne(r.value);o&&(yield o)}}finally{e.releaseLock()}}var I=(t,n,e=[],s)=>new Proxy(()=>{},{get(r,a){return I(t,n,a==="index"?e:[...e,a],s)},apply(r,a,[o,i]){if(!o||i||typeof o=="object"&&Object.keys(o).length!==1||Ee.includes(e.at(-1))){let c=[...e],f=c.pop(),u="/"+c.join("/"),{fetcher:v=fetch,headers:A,onRequest:g,onResponse:b,fetch:$}=n,E=f==="get"||f==="head"||f==="subscribe",q=E?o?.query:i?.query,j="";if(q){let l=(D,F)=>{j+=(j?"&":"?")+`${encodeURIComponent(D)}=${encodeURIComponent(F)}`};for(let[D,F]of Object.entries(q)){if(Array.isArray(F)){for(let y of F)l(D,y);continue}if(F!=null){if(typeof F=="object"){l(D,JSON.stringify(F));continue}l(D,`${F}`)}}}if(f==="subscribe"){let l=t.replace(/^([^]+):\/\//,t.startsWith("https://")?"wss://":t.startsWith("http://")||ee.find(D=>t.includes(D))?"ws://":"wss://")+u+j;return new V(l)}return(async()=>{A=await C(A,u,i);let l={method:f?.toUpperCase(),body:o,...$,headers:A};l.headers={...A,...await C(E?o?.headers:i?.headers,u,l)};let D=E&&typeof o=="object"?o.fetch:i?.fetch;if(l={...l,...D},E&&delete l.body,g){Array.isArray(g)||(g=[g]);for(let d of g){let p=await d(u,l);typeof p=="object"&&(l={...l,...p,headers:{...l.headers,...await C(p.headers,u,l)}})}}if(E&&delete l.body,N(o)){let d=new FormData,p=te(l.body);for(let[m,h]of Object.entries(p))if(Array.isArray(h))for(let w of h)w instanceof File?d.append(m,P?w:await G(w)):R(w)&&d.append(m,w);else if(h instanceof File)d.append(m,P?h:await G(h));else if(!P&&h instanceof FileList)for(let w=0;w<h.length;w++)d.append(m,await G(h[w]));else R(h),d.append(m,h);l.body=d}else typeof o=="object"?(l.headers["content-type"]="application/json",l.body=JSON.stringify(o)):o!=null&&(l.headers["content-type"]="text/plain");if(E&&delete l.body,g){Array.isArray(g)||(g=[g]);for(let d of g){let p=await d(u,l);typeof p=="object"&&(l={...l,...p,headers:{...l.headers,...await C(p.headers,u,l)}})}}i?.headers?.["content-type"]&&(l.headers["content-type"]=i?.headers["content-type"]);let F=t+u+j,y;try{y=await(s?.handle(new Request(F,l))??v(F,l))}catch(d){return{data:null,error:new O(503,d),response:void 0,status:503,headers:void 0}}let k=null,S=null;if(b){Array.isArray(b)||(b=[b]);for(let d of b)try{let p=await d(y.clone());if(p!=null){k=p;break}}catch(p){p instanceof O?S=p:S=new O(422,p);break}}if(k!==null)return{data:k,error:S,response:y,status:y.status,headers:y.headers};switch(y.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":k=ke(y);break;case"application/json":k=JSON.parse(await y.text(),(p,m)=>{if(typeof m!="string")return m;let h=U(m);return h||m});break;case"application/octet-stream":k=await y.arrayBuffer();break;case"multipart/form-data":let d=await y.formData();k={},d.forEach((p,m)=>{k[m]=p});break;default:k=await y.text().then(K)}return(y.status>=300||y.status<200)&&(S=new O(y.status,k),k=null),{data:k,error:S,response:y,status:y.status,headers:y.headers}})()}return typeof o=="object"?I(t,n,[...e,Object.values(o)[0]],s):I(t,n,e)}}),se=(t,n={})=>typeof t=="string"?(n.keepDomain||(t.includes("://")||(t=(ee.find(e=>t.includes(e))?"http://":"https://")+t),t.endsWith("/")&&(t=t.slice(0,-1))),I(t,n)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),I("http://e.ly",n,[],t));var re=(t,n,e)=>{if(t.endsWith("/")||(t+="/"),n==="index"&&(n=""),!e||!Object.keys(e).length)return`${t}${n}`;let s="";for(let[r,a]of Object.entries(e))s+=`${r}=${a}&`;return`${t}${n}?${s.slice(0,-1)}`};var H=typeof FileList>"u",T=t=>H?t instanceof Blob:t instanceof FileList||t instanceof File,W=t=>{if(!t)return!1;for(let n in t){let e=t[n];if(T(e))return!0;if(Array.isArray(e)){for(let s of e)if(T(s)||typeof s=="object"&&s!==null&&W(s))return!0}if(typeof e=="object"&&e!==null&&!(e instanceof Date)&&W(e))return!0}return!1},z=(t,n)=>{let e={},s=[];for(let[r,a]of Object.entries(t))if(T(a))s.push({key:`${n}.${r}`,value:a});else if(Array.isArray(a))if(a.some(i=>T(i)||typeof i=="object"&&i!==null&&W(i)))for(let i=0;i<a.length;i++){let c=a[i];if(T(c))s.push({key:`${n}.${r}`,value:c});else if(typeof c=="object"&&c!==null&&W(c)){let f=z(c,`${n}.${r}[${i}]`);Object.keys(f.nonFileData).length>0&&s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(f.nonFileData)}),s.push(...f.files)}else typeof c=="object"&&c!==null?s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(c)}):s.push({key:`${n}.${r}[${i}]`,value:c})}else e[r]=a;else if(typeof a=="object"&&a!==null&&!(a instanceof Date))if(W(a)){let o=z(a,`${n}.${r}`);Object.keys(o.nonFileData).length>0&&(e[r]=o.nonFileData),s.push(...o.files)}else e[r]=a;else e[r]=a;return{nonFileData:e,files:s}},ae=(t,n="")=>{let e={};for(let[s,r]of Object.entries(t)){let a=n?`${n}.${s}`:s;if(T(r))e[a]=r;else if(Array.isArray(r))if(r.some(i=>T(i)||typeof i=="object"&&i!==null&&W(i)))if(r.every(c=>T(c)))e[a]=r;else for(let c=0;c<r.length;c++){let f=r[c],u=`${a}[${c}]`;if(T(f))e[u]=f;else if(typeof f=="object"&&f!==null&&!(f instanceof Date))if(W(f)){let{nonFileData:v,files:A}=z(f,u);Object.keys(v).length>0&&(e[u]=JSON.stringify(v));for(let{key:g,value:b}of A)e[g]=b}else e[u]=JSON.stringify(f);else e[u]=f}else e[a]=JSON.stringify(r);else typeof r=="object"&&r!==null&&!(r instanceof Date)?W(r)?Object.assign(e,ae(r,a)):e[a]=JSON.stringify(r):e[a]=r}return e},Q=t=>H?t:new Promise(n=>{let e=new FileReader;e.onload=()=>{let s=new File([e.result],t.name,{lastModified:t.lastModified,type:t.type});n(s)},e.readAsArrayBuffer(t)}),X=class{ws;url;constructor(n){this.ws=new WebSocket(n),this.url=n}send(n){return Array.isArray(n)?(n.forEach(e=>this.send(e)),this):(this.ws.send(typeof n=="object"?JSON.stringify(n):n.toString()),this)}on(n,e,s){return this.addEventListener(n,e,s)}off(n,e,s){return this.ws.removeEventListener(n,e,s),this}subscribe(n,e){return this.addEventListener("message",n,e)}addEventListener(n,e,s){return this.ws.addEventListener(n,r=>{if(n==="message"){let a=B(r);e({...r,data:a})}else e(r)},s),this}removeEventListener(n,e,s){return this.off(n,e,s),this}close(){return this.ws.close(),this}},ie=(t,n="",e)=>new Proxy(()=>{},{get(s,r,a){return ie(t,`${n}/${r.toString()}`,e)},apply(s,r,[a,o={}]=[{},{}]){let i=a!==void 0&&(typeof a!="object"||Array.isArray(a))?a:void 0,{$query:c,$fetch:f,$headers:u,$transform:v,getRaw:A,...g}=a??{};i??=g;let b=n.lastIndexOf("/"),$=n.slice(b+1).toUpperCase(),E=re(t,b===-1?"/":n.slice(0,b),Object.assign(o.query??{},c)),q=e.fetcher??fetch,j=e.transform?Array.isArray(e.transform)?e.transform:[e.transform]:void 0,l=v?Array.isArray(v)?v:[v]:void 0;return l&&(j?j=l.concat(j):j=l),$==="SUBSCRIBE"?new X(E.replace(/^([^]+):\/\//,E.startsWith("https://")?"wss://":"ws://")):(async F=>{let y,k={...e.$fetch?.headers,...f?.headers,...o.headers,...u};if($!=="GET"&&$!=="HEAD"){y=Object.keys(i).length||Array.isArray(i)?i:void 0;let h=y&&(typeof y=="object"||Array.isArray(i));if(h&&W(y)){let M=new FormData,fe=ae(y);for(let[J,x]of Object.entries(fe))if(Array.isArray(x))for(let L of x)L instanceof File?M.append(J,H?L:await Q(L)):T(L)&&M.append(J,L);else if(x instanceof File)M.append(J,H?x:await Q(x));else if(!H&&x instanceof FileList)for(let L=0;L<x.length;L++)M.append(J,await Q(x[L]));else T(x),M.append(J,x);y=M}else y!=null&&(k["content-type"]=h?"application/json":"text/plain",y=h?JSON.stringify(y):i)}let S=await q(E,{method:$,body:y,...e.$fetch,...o.fetch,...f,headers:k}),d;if(F.getRaw)return S;S.headers.get("Content-Type")?.split(";")[0]==="application/json"?d=await S.json():d=await S.text().then(K);let p=S.status>=300||S.status<200?new O(S.status,d):null,m={data:d,error:p,response:S,status:S.status,headers:S.headers};if(j)for(let h of j){let w=h(m);w instanceof Promise&&(w=await w),w!=null&&(m=w)}return m})({getRaw:A})}}),oe=(t,n={fetcher:fetch})=>new Proxy({},{get(e,s){return ie(t,s,n)}});var Ae=async t=>{switch(t.headers.get("Content-Type")?.split(";")[0]){case"application/json":return t.json();case"application/octet-stream":return t.arrayBuffer();case"multipart/form-data":{let e=await t.formData(),s={};return e.forEach((r,a)=>{s[a]=r}),s}}return t.text().then(K)},$e=async(t,n)=>{let e=await Ae(t);return t.status>300?{data:null,status:t.status,headers:t.headers,retry:n,error:new O(t.status,e)}:{data:e,error:null,status:t.status,headers:t.headers,retry:n}},ce=(t,n)=>(e,{query:s,params:r,body:a,...o}={})=>{r&&Object.entries(r).forEach(([$,E])=>{e=e.replace(`:${$}`,E)});let i=n?.fetcher||globalThis.fetch,c=s?Object.fromEntries(Object.entries(s).filter(([$,E])=>E!=null)):null,f=c?`?${new URLSearchParams(c).toString()}`:"",u=`${t}${e}${f}`,v=new Headers(o.headers||{}),A=v.get("content-type");if(!(a instanceof FormData)&&!(a instanceof URLSearchParams)&&(!A||A==="application/json"))try{a=JSON.stringify(a),A||v.set("content-type","application/json")}catch{}let g={...o,method:o.method?.toUpperCase()||"GET",headers:v,body:a},b=()=>i(u,g).then($=>$e($,b)).catch($=>({data:null,error:new O(503,$),status:503,headers:void 0,retry:b}));return b()};return he(Fe);})();
diff --git a/dist/index.js b/dist/index.js
index b240e360cc30dda2205c51461d22db2d0c2bae33..2f278f3ee3c4892eb8cad82773b663ed6dbadb60 100644
--- a/dist/index.js
+++ b/dist/index.js
@@ -1,4 +1,4 @@
-"use strict";var U=Object.defineProperty;var se=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var ie=Object.prototype.hasOwnProperty;var oe=(e,t)=>{for(var n in t)U(e,n,{get:t[n],enumerable:!0})},ce=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of ae(t))!ie.call(e,s)&&s!==n&&U(e,s,{get:()=>t[s],enumerable:!(r=se(t,s))||r.enumerable});return e};var fe=e=>ce(U({},"__esModule",{value:!0}),e);var ke={};oe(ke,{EdenFetchError:()=>S,edenFetch:()=>re,edenTreaty:()=>ne,treaty:()=>X});module.exports=fe(ke);var S=class extends Error{constructor(n,r){super(r+"");this.status=n;this.value=r}};var de=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,ue=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,ye=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,le=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),D=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(de.test(t)||ue.test(t)||ye.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},pe=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},he=e=>JSON.parse(e,(t,n)=>{let r=D(n);return r||n}),$=e=>{if(!e)return e;if(le(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=D(e);if(t)return t;if(pe(e))try{return he(e)}catch{}return e},I=e=>{let t=e.data.toString();return t==="null"?null:$(t)};var P=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,s=>{if(t==="message"){let i=I(s);n({...s,data:i})}else n(s)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}};var ge=["get","post","put","delete","patch","options","head","connect","subscribe"],Q=["localhost","127.0.0.1","0.0.0.0"],V=typeof FileList>"u",q=e=>V?e instanceof Blob:e instanceof FileList||e instanceof File,me=e=>{if(!e)return!1;for(let t in e)if(q(e[t])||Array.isArray(e[t])&&e[t].find(q))return!0;return!1},B=e=>V?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),C=async(e,t,n={},r={})=>{if(Array.isArray(e)){for(let s of e)if(!Array.isArray(s))r=await C(s,t,n,r);else{let i=s[0];if(typeof i=="string")r[i.toLowerCase()]=s[1];else for(let[a,d]of i)r[a.toLowerCase()]=d}return r}if(!e)return r;switch(typeof e){case"function":if(e instanceof Headers)return C(e,t,n,r);let s=await e(t,n);return s?C(s,t,n,r):r;case"object":if(e instanceof Headers)return e.forEach((i,a)=>{r[a.toLowerCase()]=i}),r;for(let[i,a]of Object.entries(e))r[i.toLowerCase()]=a;return r;default:return r}};function z(e){let t=e.split(`
-`),n={};for(let r of t){if(!r||r.startsWith(":"))continue;let s=r.indexOf(":");if(s>0){let i=r.slice(0,s).trim(),a=r.slice(s+1).replace(/^ /,"");n[i]=a&&$(a)}}return Object.keys(n).length>0?n:null}function*Z(e){let t;for(;(t=e.value.indexOf(`
+"use strict";var _=Object.defineProperty;var le=Object.getOwnPropertyDescriptor;var ye=Object.getOwnPropertyNames;var ue=Object.prototype.hasOwnProperty;var de=(t,n)=>{for(var e in n)_(t,e,{get:n[e],enumerable:!0})},pe=(t,n,e,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let r of ye(n))!ue.call(t,r)&&r!==e&&_(t,r,{get:()=>n[r],enumerable:!(s=le(n,r))||s.enumerable});return t};var he=t=>pe(_({},"__esModule",{value:!0}),t);var Fe={};de(Fe,{EdenFetchError:()=>O,edenFetch:()=>ce,edenTreaty:()=>oe,treaty:()=>se});module.exports=he(Fe);var O=class extends Error{constructor(e,s){super(s+"");this.status=e;this.value=s}};var ge=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,be=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,me=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,we=t=>t.trim().length!==0&&!Number.isNaN(Number(t)),U=t=>{if(typeof t!="string")return null;let n=t.replace(/"/g,"");if(ge.test(n)||be.test(n)||me.test(n)){let e=new Date(n);if(!Number.isNaN(e.getTime()))return e}return null},ve=t=>{let n=t.charCodeAt(0),e=t.charCodeAt(t.length-1);return n===123&&e===125||n===91&&e===93},Se=t=>JSON.parse(t,(n,e)=>{let s=U(e);return s||e}),K=t=>{if(!t)return t;if(we(t))return+t;if(t==="true")return!0;if(t==="false")return!1;let n=U(t);if(n)return n;if(ve(t))try{return Se(t)}catch{}return t},B=t=>{let n=t.data.toString();return n==="null"?null:K(n)};var V=class{constructor(n){this.url=n;this.ws=new WebSocket(n)}ws;send(n){return Array.isArray(n)?(n.forEach(e=>this.send(e)),this):(this.ws.send(typeof n=="object"?JSON.stringify(n):n.toString()),this)}on(n,e,s){return this.addEventListener(n,e,s)}off(n,e,s){return this.ws.removeEventListener(n,e,s),this}subscribe(n,e){return this.addEventListener("message",n,e)}addEventListener(n,e,s){return this.ws.addEventListener(n,r=>{if(n==="message"){let a=B(r);e({...r,data:a})}else e(r)},s),this}removeEventListener(n,e,s){return this.off(n,e,s),this}close(){return this.ws.close(),this}};var Ee=["get","post","put","delete","patch","options","head","connect","subscribe"],ee=["localhost","127.0.0.1","0.0.0.0"],P=typeof FileList>"u",R=t=>P?t instanceof Blob:t instanceof FileList||t instanceof File,N=t=>{if(!t)return!1;for(let n in t){let e=t[n];if(R(e))return!0;if(Array.isArray(e)){for(let s of e)if(R(s)||typeof s=="object"&&s!==null&&N(s))return!0}else if(typeof e=="object"&&e!==null&&!(e instanceof Date)&&N(e))return!0}return!1},Z=(t,n)=>{let e={},s=[];for(let[r,a]of Object.entries(t))if(R(a))s.push({key:`${n}.${r}`,value:a});else if(Array.isArray(a))if(a.some(i=>R(i)||typeof i=="object"&&i!==null&&N(i)))for(let i=0;i<a.length;i++){let c=a[i];if(R(c))s.push({key:`${n}.${r}[${i}]`,value:c});else if(typeof c=="object"&&c!==null&&N(c)){let f=Z(c,`${n}.${r}[${i}]`);Object.keys(f.nonFileData).length>0&&s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(f.nonFileData)}),s.push(...f.files)}else typeof c=="object"&&c!==null?s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(c)}):s.push({key:`${n}.${r}[${i}]`,value:c})}else e[r]=a;else if(typeof a=="object"&&a!==null&&!(a instanceof Date))if(N(a)){let o=Z(a,`${n}.${r}`);Object.keys(o.nonFileData).length>0&&(e[r]=o.nonFileData),s.push(...o.files)}else e[r]=a;else e[r]=a;return{nonFileData:e,files:s}},te=(t,n="")=>{let e={};for(let[s,r]of Object.entries(t)){let a=n?`${n}.${s}`:s;if(R(r))e[a]=r;else if(Array.isArray(r))if(r.some(i=>R(i)||typeof i=="object"&&i!==null&&N(i)))if(r.every(c=>R(c)))for(let c=0;c<r.length;c++)e[`${a}[${c}]`]=r[c];else for(let c=0;c<r.length;c++){let f=r[c],u=`${a}[${c}]`;if(R(f))e[u]=f;else if(typeof f=="object"&&f!==null&&!(f instanceof Date))if(N(f)){let{nonFileData:v,files:A}=Z(f,u);Object.keys(v).length>0&&(e[u]=JSON.stringify(v));for(let{key:g,value:b}of A)e[g]=b}else e[u]=JSON.stringify(f);else e[u]=f}else e[a]=JSON.stringify(r);else typeof r=="object"&&r!==null&&!(r instanceof Date)?N(r)?Object.assign(e,te(r,a)):e[a]=JSON.stringify(r):e[a]=r}return e},G=t=>P?t:new Promise(n=>{let e=new FileReader;e.onload=()=>{let s=new File([e.result],t.name,{lastModified:t.lastModified,type:t.type});n(s)},e.readAsArrayBuffer(t)}),C=async(t,n,e={},s={})=>{if(Array.isArray(t)){for(let r of t)if(!Array.isArray(r))s=await C(r,n,e,s);else{let a=r[0];if(typeof a=="string")s[a.toLowerCase()]=r[1];else for(let[o,i]of a)s[o.toLowerCase()]=i}return s}if(!t)return s;switch(typeof t){case"function":if(t instanceof Headers)return C(t,n,e,s);let r=await t(n,e);return r?C(r,n,e,s):s;case"object":if(t instanceof Headers)return t.forEach((a,o)=>{s[o.toLowerCase()]=a}),s;for(let[a,o]of Object.entries(t))s[a.toLowerCase()]=o;return s;default:return s}};function ne(t){let n=t.split(`
+`),e={};for(let s of n){if(!s||s.startsWith(":"))continue;let r=s.indexOf(":");if(r>0){let a=s.slice(0,r).trim(),o=s.slice(r+1).replace(/^ /,"");e[a]=o&&K(o)}}return Object.keys(e).length>0?e:null}function*Y(t){let n;for(;(n=t.value.indexOf(`
 
-`))!==-1;){let n=e.value.slice(0,t);if(e.value=e.value.slice(t+2),n.trim()){let r=z(n);r&&(yield r)}}}async function*we(e){let t=e.body;if(!t)return;let n=t.getReader(),r=new TextDecoder("utf-8"),s={value:""};try{for(;;){let{done:a,value:d}=await n.read();if(a)break;let W=typeof d=="string"?d:r.decode(d,{stream:!0});s.value+=W,yield*Z(s)}let i=r.decode();if(i&&(s.value+=i),yield*Z(s),s.value.trim()){let a=z(s.value);a&&(yield a)}}finally{n.releaseLock()}}var K=(e,t,n=[],r)=>new Proxy(()=>{},{get(s,i){return K(e,t,i==="index"?n:[...n,i],r)},apply(s,i,[a,d]){if(!a||d||typeof a=="object"&&Object.keys(a).length!==1||ge.includes(n.at(-1))){let W=[...n],F=W.pop(),A="/"+W.join("/"),{fetcher:R=fetch,headers:j,onRequest:w,onResponse:k,fetch:E}=t,h=F==="get"||F==="head"||F==="subscribe",N=h?a?.query:d?.query,O="";if(N){let o=(L,b)=>{O+=(O?"&":"?")+`${encodeURIComponent(L)}=${encodeURIComponent(b)}`};for(let[L,b]of Object.entries(N)){if(Array.isArray(b)){for(let c of b)o(L,c);continue}if(b!=null){if(typeof b=="object"){o(L,JSON.stringify(b));continue}o(L,`${b}`)}}}if(F==="subscribe"){let o=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||Q.find(L=>e.includes(L))?"ws://":"wss://")+A+O;return new P(o)}return(async()=>{j=await C(j,A,d);let o={method:F?.toUpperCase(),body:a,...E,headers:j};o.headers={...j,...await C(h?a?.headers:d?.headers,A,o)};let L=h&&typeof a=="object"?a.fetch:d?.fetch;if(o={...o,...L},h&&delete o.body,w){Array.isArray(w)||(w=[w]);for(let u of w){let y=await u(A,o);typeof y=="object"&&(o={...o,...y,headers:{...o.headers,...await C(y.headers,A,o)}})}}if(h&&delete o.body,me(a)){let u=new FormData,y=f=>{if(typeof f=="string"||q(f))return!1;if(typeof f=="object"){if(f!==null)return!0;if(f instanceof Date)return!1}return!1},m=async f=>f instanceof File?await B(f):y(f)?JSON.stringify(f):f;for(let[f,l]of Object.entries(o.body)){if(Array.isArray(l)){if(l.some(v=>typeof v=="object"&&v!==null&&!q(v)))u.append(f,JSON.stringify(l));else for(let v=0;v<l.length;v++){let T=l[v],M=await m(T);u.append(f,M)}continue}if(V){if(Array.isArray(l))for(let x of l)u.append(f,await m(x));else u.append(f,await m(l));continue}if(l instanceof File){u.append(f,await B(l));continue}if(l instanceof FileList){for(let x=0;x<l.length;x++)u.append(f,await B(l[x]));continue}u.append(f,await m(l))}o.body=u}else typeof a=="object"?(o.headers["content-type"]="application/json",o.body=JSON.stringify(a)):a!=null&&(o.headers["content-type"]="text/plain");if(h&&delete o.body,w){Array.isArray(w)||(w=[w]);for(let u of w){let y=await u(A,o);typeof y=="object"&&(o={...o,...y,headers:{...o.headers,...await C(y.headers,A,o)}})}}d?.headers?.["content-type"]&&(o.headers["content-type"]=d?.headers["content-type"]);let b=e+A+O,c;try{c=await(r?.handle(new Request(b,o))??R(b,o))}catch(u){return{data:null,error:new S(503,u),response:void 0,status:503,headers:void 0}}let g=null,p=null;if(k){Array.isArray(k)||(k=[k]);for(let u of k)try{let y=await u(c.clone());if(y!=null){g=y;break}}catch(y){y instanceof S?p=y:p=new S(422,y);break}}if(g!==null)return{data:g,error:p,response:c,status:c.status,headers:c.headers};switch(c.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":g=we(c);break;case"application/json":g=JSON.parse(await c.text(),(y,m)=>{if(typeof m!="string")return m;let f=D(m);return f||m});break;case"application/octet-stream":g=await c.arrayBuffer();break;case"multipart/form-data":let u=await c.formData();g={},u.forEach((y,m)=>{g[m]=y});break;default:g=await c.text().then($)}return(c.status>=300||c.status<200)&&(p=new S(c.status,g),g=null),{data:g,error:p,response:c,status:c.status,headers:c.headers}})()}return typeof a=="object"?K(e,t,[...n,Object.values(a)[0]],r):K(e,t,n)}}),X=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(Q.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),K(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),K("http://e.ly",t,[],e));var Y=(e,t,n)=>{if(e.endsWith("/")||(e+="/"),t==="index"&&(t=""),!n||!Object.keys(n).length)return`${e}${t}`;let r="";for(let[s,i]of Object.entries(n))r+=`${s}=${i}&`;return`${e}${t}?${r.slice(0,-1)}`};var G=typeof FileList>"u",ee=e=>G?e instanceof Blob:e instanceof FileList||e instanceof File,Ee=e=>{if(!e)return!1;for(let t in e){if(ee(e[t]))return!0;if(Array.isArray(e[t])&&e[t].find(n=>ee(n)))return!0}return!1},H=e=>G?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),_=class{ws;url;constructor(t){this.ws=new WebSocket(t),this.url=t}send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,s=>{if(t==="message"){let i=I(s);n({...s,data:i})}else n(s)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}},te=(e,t="",n)=>new Proxy(()=>{},{get(r,s,i){return te(e,`${t}/${s.toString()}`,n)},apply(r,s,[i,a={}]=[{},{}]){let d=i!==void 0&&(typeof i!="object"||Array.isArray(i))?i:void 0,{$query:W,$fetch:F,$headers:A,$transform:R,getRaw:j,...w}=i??{};d??=w;let k=t.lastIndexOf("/"),E=t.slice(k+1).toUpperCase(),h=Y(e,k===-1?"/":t.slice(0,k),Object.assign(a.query??{},W)),N=n.fetcher??fetch,O=n.transform?Array.isArray(n.transform)?n.transform:[n.transform]:void 0,o=R?Array.isArray(R)?R:[R]:void 0;return o&&(O?O=o.concat(O):O=o),E==="SUBSCRIBE"?new _(h.replace(/^([^]+):\/\//,h.startsWith("https://")?"wss://":"ws://")):(async b=>{let c,g={...n.$fetch?.headers,...F?.headers,...a.headers,...A};if(E!=="GET"&&E!=="HEAD"){c=Object.keys(d).length||Array.isArray(d)?d:void 0;let f=c&&(typeof c=="object"||Array.isArray(d));if(f&&Ee(c)){let x=new FormData;for(let[v,T]of Object.entries(c))if(G)x.append(v,T);else if(T instanceof File)x.append(v,await H(T));else if(T instanceof FileList)for(let M=0;M<T.length;M++)x.append(v,await H(T[M]));else if(Array.isArray(T))for(let M=0;M<T.length;M++){let J=T[M];x.append(v,J instanceof File?await H(J):J)}else x.append(v,T);c=x}else c!=null&&(g["content-type"]=f?"application/json":"text/plain",c=f?JSON.stringify(c):d)}let p=await N(h,{method:E,body:c,...n.$fetch,...a.fetch,...F,headers:g}),u;if(b.getRaw)return p;switch(p.headers.get("Content-Type")?.split(";")[0]){case"application/json":u=await p.json();break;default:u=await p.text().then($)}let y=p.status>=300||p.status<200?new S(p.status,u):null,m={data:u,error:y,response:p,status:p.status,headers:p.headers};if(O)for(let f of O){let l=f(m);l instanceof Promise&&(l=await l),l!=null&&(m=l)}return m})({getRaw:j})}}),ne=(e,t={fetcher:fetch})=>new Proxy({},{get(n,r){return te(e,r,t)}});var be=async e=>{switch(e.headers.get("Content-Type")?.split(";")[0]){case"application/json":return e.json();case"application/octet-stream":return e.arrayBuffer();case"multipart/form-data":{let n=await e.formData(),r={};return n.forEach((s,i)=>{r[i]=s}),r}}return e.text().then($)},Se=async(e,t)=>{let n=await be(e);return e.status>300?{data:null,status:e.status,headers:e.headers,retry:t,error:new S(e.status,n)}:{data:n,error:null,status:e.status,headers:e.headers,retry:t}},re=(e,t)=>(n,{query:r,params:s,body:i,...a}={})=>{s&&Object.entries(s).forEach(([E,h])=>{n=n.replace(`:${E}`,h)});let d=t?.fetcher||globalThis.fetch,W=r?Object.fromEntries(Object.entries(r).filter(([E,h])=>h!=null)):null,F=W?`?${new URLSearchParams(W).toString()}`:"",A=`${e}${n}${F}`,R=new Headers(a.headers||{}),j=R.get("content-type");if(!(i instanceof FormData)&&!(i instanceof URLSearchParams)&&(!j||j==="application/json"))try{i=JSON.stringify(i),j||R.set("content-type","application/json")}catch{}let w={...a,method:a.method?.toUpperCase()||"GET",headers:R,body:i},k=()=>d(A,w).then(E=>Se(E,k)).catch(E=>({data:null,error:new S(503,E),status:503,headers:void 0,retry:k}));return k()};0&&(module.exports={EdenFetchError,edenFetch,edenTreaty,treaty});
+`))!==-1;){let e=t.value.slice(0,n);if(t.value=t.value.slice(n+2),e.trim()){let s=ne(e);s&&(yield s)}}}async function*ke(t){let n=t.body;if(!n)return;let e=n.getReader(),s=new TextDecoder("utf-8"),r={value:""};try{for(;;){let{done:o,value:i}=await e.read();if(o)break;let c=typeof i=="string"?i:s.decode(i,{stream:!0});r.value+=c,yield*Y(r)}let a=s.decode();if(a&&(r.value+=a),yield*Y(r),r.value.trim()){let o=ne(r.value);o&&(yield o)}}finally{e.releaseLock()}}var I=(t,n,e=[],s)=>new Proxy(()=>{},{get(r,a){return I(t,n,a==="index"?e:[...e,a],s)},apply(r,a,[o,i]){if(!o||i||typeof o=="object"&&Object.keys(o).length!==1||Ee.includes(e.at(-1))){let c=[...e],f=c.pop(),u="/"+c.join("/"),{fetcher:v=fetch,headers:A,onRequest:g,onResponse:b,fetch:$}=n,E=f==="get"||f==="head"||f==="subscribe",q=E?o?.query:i?.query,j="";if(q){let l=(D,F)=>{j+=(j?"&":"?")+`${encodeURIComponent(D)}=${encodeURIComponent(F)}`};for(let[D,F]of Object.entries(q)){if(Array.isArray(F)){for(let y of F)l(D,y);continue}if(F!=null){if(typeof F=="object"){l(D,JSON.stringify(F));continue}l(D,`${F}`)}}}if(f==="subscribe"){let l=t.replace(/^([^]+):\/\//,t.startsWith("https://")?"wss://":t.startsWith("http://")||ee.find(D=>t.includes(D))?"ws://":"wss://")+u+j;return new V(l)}return(async()=>{A=await C(A,u,i);let l={method:f?.toUpperCase(),body:o,...$,headers:A};l.headers={...A,...await C(E?o?.headers:i?.headers,u,l)};let D=E&&typeof o=="object"?o.fetch:i?.fetch;if(l={...l,...D},E&&delete l.body,g){Array.isArray(g)||(g=[g]);for(let d of g){let p=await d(u,l);typeof p=="object"&&(l={...l,...p,headers:{...l.headers,...await C(p.headers,u,l)}})}}if(E&&delete l.body,N(o)){let d=new FormData,p=te(l.body);for(let[m,h]of Object.entries(p))if(Array.isArray(h))for(let w of h)w instanceof File?d.append(m,P?w:await G(w)):R(w)&&d.append(m,w);else if(h instanceof File)d.append(m,P?h:await G(h));else if(!P&&h instanceof FileList)for(let w=0;w<h.length;w++)d.append(m,await G(h[w]));else R(h),d.append(m,h);l.body=d}else typeof o=="object"?(l.headers["content-type"]="application/json",l.body=JSON.stringify(o)):o!=null&&(l.headers["content-type"]="text/plain");if(E&&delete l.body,g){Array.isArray(g)||(g=[g]);for(let d of g){let p=await d(u,l);typeof p=="object"&&(l={...l,...p,headers:{...l.headers,...await C(p.headers,u,l)}})}}i?.headers?.["content-type"]&&(l.headers["content-type"]=i?.headers["content-type"]);let F=t+u+j,y;try{y=await(s?.handle(new Request(F,l))??v(F,l))}catch(d){return{data:null,error:new O(503,d),response:void 0,status:503,headers:void 0}}let k=null,S=null;if(b){Array.isArray(b)||(b=[b]);for(let d of b)try{let p=await d(y.clone());if(p!=null){k=p;break}}catch(p){p instanceof O?S=p:S=new O(422,p);break}}if(k!==null)return{data:k,error:S,response:y,status:y.status,headers:y.headers};switch(y.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":k=ke(y);break;case"application/json":k=JSON.parse(await y.text(),(p,m)=>{if(typeof m!="string")return m;let h=U(m);return h||m});break;case"application/octet-stream":k=await y.arrayBuffer();break;case"multipart/form-data":let d=await y.formData();k={},d.forEach((p,m)=>{k[m]=p});break;default:k=await y.text().then(K)}return(y.status>=300||y.status<200)&&(S=new O(y.status,k),k=null),{data:k,error:S,response:y,status:y.status,headers:y.headers}})()}return typeof o=="object"?I(t,n,[...e,Object.values(o)[0]],s):I(t,n,e)}}),se=(t,n={})=>typeof t=="string"?(n.keepDomain||(t.includes("://")||(t=(ee.find(e=>t.includes(e))?"http://":"https://")+t),t.endsWith("/")&&(t=t.slice(0,-1))),I(t,n)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),I("http://e.ly",n,[],t));var re=(t,n,e)=>{if(t.endsWith("/")||(t+="/"),n==="index"&&(n=""),!e||!Object.keys(e).length)return`${t}${n}`;let s="";for(let[r,a]of Object.entries(e))s+=`${r}=${a}&`;return`${t}${n}?${s.slice(0,-1)}`};var H=typeof FileList>"u",T=t=>H?t instanceof Blob:t instanceof FileList||t instanceof File,W=t=>{if(!t)return!1;for(let n in t){let e=t[n];if(T(e))return!0;if(Array.isArray(e)){for(let s of e)if(T(s)||typeof s=="object"&&s!==null&&W(s))return!0}if(typeof e=="object"&&e!==null&&!(e instanceof Date)&&W(e))return!0}return!1},z=(t,n)=>{let e={},s=[];for(let[r,a]of Object.entries(t))if(T(a))s.push({key:`${n}.${r}`,value:a});else if(Array.isArray(a))if(a.some(i=>T(i)||typeof i=="object"&&i!==null&&W(i)))for(let i=0;i<a.length;i++){let c=a[i];if(T(c))s.push({key:`${n}.${r}`,value:c});else if(typeof c=="object"&&c!==null&&W(c)){let f=z(c,`${n}.${r}[${i}]`);Object.keys(f.nonFileData).length>0&&s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(f.nonFileData)}),s.push(...f.files)}else typeof c=="object"&&c!==null?s.push({key:`${n}.${r}[${i}]`,value:JSON.stringify(c)}):s.push({key:`${n}.${r}[${i}]`,value:c})}else e[r]=a;else if(typeof a=="object"&&a!==null&&!(a instanceof Date))if(W(a)){let o=z(a,`${n}.${r}`);Object.keys(o.nonFileData).length>0&&(e[r]=o.nonFileData),s.push(...o.files)}else e[r]=a;else e[r]=a;return{nonFileData:e,files:s}},ae=(t,n="")=>{let e={};for(let[s,r]of Object.entries(t)){let a=n?`${n}.${s}`:s;if(T(r))e[a]=r;else if(Array.isArray(r))if(r.some(i=>T(i)||typeof i=="object"&&i!==null&&W(i)))if(r.every(c=>T(c)))e[a]=r;else for(let c=0;c<r.length;c++){let f=r[c],u=`${a}[${c}]`;if(T(f))e[u]=f;else if(typeof f=="object"&&f!==null&&!(f instanceof Date))if(W(f)){let{nonFileData:v,files:A}=z(f,u);Object.keys(v).length>0&&(e[u]=JSON.stringify(v));for(let{key:g,value:b}of A)e[g]=b}else e[u]=JSON.stringify(f);else e[u]=f}else e[a]=JSON.stringify(r);else typeof r=="object"&&r!==null&&!(r instanceof Date)?W(r)?Object.assign(e,ae(r,a)):e[a]=JSON.stringify(r):e[a]=r}return e},Q=t=>H?t:new Promise(n=>{let e=new FileReader;e.onload=()=>{let s=new File([e.result],t.name,{lastModified:t.lastModified,type:t.type});n(s)},e.readAsArrayBuffer(t)}),X=class{ws;url;constructor(n){this.ws=new WebSocket(n),this.url=n}send(n){return Array.isArray(n)?(n.forEach(e=>this.send(e)),this):(this.ws.send(typeof n=="object"?JSON.stringify(n):n.toString()),this)}on(n,e,s){return this.addEventListener(n,e,s)}off(n,e,s){return this.ws.removeEventListener(n,e,s),this}subscribe(n,e){return this.addEventListener("message",n,e)}addEventListener(n,e,s){return this.ws.addEventListener(n,r=>{if(n==="message"){let a=B(r);e({...r,data:a})}else e(r)},s),this}removeEventListener(n,e,s){return this.off(n,e,s),this}close(){return this.ws.close(),this}},ie=(t,n="",e)=>new Proxy(()=>{},{get(s,r,a){return ie(t,`${n}/${r.toString()}`,e)},apply(s,r,[a,o={}]=[{},{}]){let i=a!==void 0&&(typeof a!="object"||Array.isArray(a))?a:void 0,{$query:c,$fetch:f,$headers:u,$transform:v,getRaw:A,...g}=a??{};i??=g;let b=n.lastIndexOf("/"),$=n.slice(b+1).toUpperCase(),E=re(t,b===-1?"/":n.slice(0,b),Object.assign(o.query??{},c)),q=e.fetcher??fetch,j=e.transform?Array.isArray(e.transform)?e.transform:[e.transform]:void 0,l=v?Array.isArray(v)?v:[v]:void 0;return l&&(j?j=l.concat(j):j=l),$==="SUBSCRIBE"?new X(E.replace(/^([^]+):\/\//,E.startsWith("https://")?"wss://":"ws://")):(async F=>{let y,k={...e.$fetch?.headers,...f?.headers,...o.headers,...u};if($!=="GET"&&$!=="HEAD"){y=Object.keys(i).length||Array.isArray(i)?i:void 0;let h=y&&(typeof y=="object"||Array.isArray(i));if(h&&W(y)){let M=new FormData,fe=ae(y);for(let[J,x]of Object.entries(fe))if(Array.isArray(x))for(let L of x)L instanceof File?M.append(J,H?L:await Q(L)):T(L)&&M.append(J,L);else if(x instanceof File)M.append(J,H?x:await Q(x));else if(!H&&x instanceof FileList)for(let L=0;L<x.length;L++)M.append(J,await Q(x[L]));else T(x),M.append(J,x);y=M}else y!=null&&(k["content-type"]=h?"application/json":"text/plain",y=h?JSON.stringify(y):i)}let S=await q(E,{method:$,body:y,...e.$fetch,...o.fetch,...f,headers:k}),d;if(F.getRaw)return S;S.headers.get("Content-Type")?.split(";")[0]==="application/json"?d=await S.json():d=await S.text().then(K);let p=S.status>=300||S.status<200?new O(S.status,d):null,m={data:d,error:p,response:S,status:S.status,headers:S.headers};if(j)for(let h of j){let w=h(m);w instanceof Promise&&(w=await w),w!=null&&(m=w)}return m})({getRaw:A})}}),oe=(t,n={fetcher:fetch})=>new Proxy({},{get(e,s){return ie(t,s,n)}});var Ae=async t=>{switch(t.headers.get("Content-Type")?.split(";")[0]){case"application/json":return t.json();case"application/octet-stream":return t.arrayBuffer();case"multipart/form-data":{let e=await t.formData(),s={};return e.forEach((r,a)=>{s[a]=r}),s}}return t.text().then(K)},$e=async(t,n)=>{let e=await Ae(t);return t.status>300?{data:null,status:t.status,headers:t.headers,retry:n,error:new O(t.status,e)}:{data:e,error:null,status:t.status,headers:t.headers,retry:n}},ce=(t,n)=>(e,{query:s,params:r,body:a,...o}={})=>{r&&Object.entries(r).forEach(([$,E])=>{e=e.replace(`:${$}`,E)});let i=n?.fetcher||globalThis.fetch,c=s?Object.fromEntries(Object.entries(s).filter(([$,E])=>E!=null)):null,f=c?`?${new URLSearchParams(c).toString()}`:"",u=`${t}${e}${f}`,v=new Headers(o.headers||{}),A=v.get("content-type");if(!(a instanceof FormData)&&!(a instanceof URLSearchParams)&&(!A||A==="application/json"))try{a=JSON.stringify(a),A||v.set("content-type","application/json")}catch{}let g={...o,method:o.method?.toUpperCase()||"GET",headers:v,body:a},b=()=>i(u,g).then($=>$e($,b)).catch($=>({data:null,error:new O(503,$),status:503,headers:void 0,retry:b}));return b()};0&&(module.exports={EdenFetchError,edenFetch,edenTreaty,treaty});
diff --git a/dist/index.mjs b/dist/index.mjs
index a10564de5be2008eb65428ba3411516026f9ac75..540d0ea7471b4bc3261d1fa7daa0067f74559161 100644
--- a/dist/index.mjs
+++ b/dist/index.mjs
@@ -1 +1 @@
-import{b as t}from"./chunk-EF6Z4LSD.mjs";import{b as r}from"./chunk-7WR4DS5F.mjs";import{a as o}from"./chunk-VMSCNLL4.mjs";import{a as e}from"./chunk-QSLHAOSM.mjs";export{e as EdenFetchError,o as edenFetch,t as edenTreaty,r as treaty};
+import{b as t}from"./chunk-F3GV6FPC.mjs";import{b as r}from"./chunk-3RD5JO62.mjs";import{a as o}from"./chunk-VMSCNLL4.mjs";import{a as e}from"./chunk-QSLHAOSM.mjs";export{e as EdenFetchError,o as edenFetch,t as edenTreaty,r as treaty};
diff --git a/dist/treaty.global.js b/dist/treaty.global.js
index 6581d5d8e92a0cf3b30aae2b5eae13060fd18c26..e8c307e5ee701d0642775c9c49734ed49327e5ae 100644
--- a/dist/treaty.global.js
+++ b/dist/treaty.global.js
@@ -1 +1 @@
-"use strict";var Eden=(()=>{var v=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var U=(t,e)=>{for(var n in e)v(t,n,{get:e[n],enumerable:!0})},_=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of G(e))!H.call(t,s)&&s!==n&&v(t,s,{get:()=>e[s],enumerable:!(r=B(e,s))||r.enumerable});return t};var z=t=>_(v({},"__esModule",{value:!0}),t);var ae={};U(ae,{EdenWS:()=>b,edenTreaty:()=>se});var S=class extends Error{constructor(n,r){super(r+"");this.status=n;this.value=r}};var L=(t,e,n)=>{if(t.endsWith("/")||(t+="/"),e==="index"&&(e=""),!n||!Object.keys(n).length)return`${t}${e}`;let r="";for(let[s,i]of Object.entries(n))r+=`${s}=${i}&`;return`${t}${e}?${r.slice(0,-1)}`};var Q=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,X=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,Y=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,ee=t=>t.trim().length!==0&&!Number.isNaN(Number(t)),N=t=>{if(typeof t!="string")return null;let e=t.replace(/"/g,"");if(Q.test(e)||X.test(e)||Y.test(e)){let n=new Date(e);if(!Number.isNaN(n.getTime()))return n}return null},te=t=>{let e=t.charCodeAt(0),n=t.charCodeAt(t.length-1);return e===123&&n===125||e===91&&n===93},ne=t=>JSON.parse(t,(e,n)=>{let r=N(n);return r||n}),$=t=>{if(!t)return t;if(ee(t))return+t;if(t==="true")return!0;if(t==="false")return!1;let e=N(t);if(e)return e;if(te(t))try{return ne(t)}catch{}return t},K=t=>{let e=t.data.toString();return e==="null"?null:$(e)};var M=typeof FileList>"u",j=t=>M?t instanceof Blob:t instanceof FileList||t instanceof File,re=t=>{if(!t)return!1;for(let e in t){if(j(t[e]))return!0;if(Array.isArray(t[e])&&t[e].find(n=>j(n)))return!0}return!1},F=t=>M?t:new Promise(e=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],t.name,{lastModified:t.lastModified,type:t.type});e(r)},n.readAsArrayBuffer(t)}),b=class{ws;url;constructor(e){this.ws=new WebSocket(e),this.url=e}send(e){return Array.isArray(e)?(e.forEach(n=>this.send(n)),this):(this.ws.send(typeof e=="object"?JSON.stringify(e):e.toString()),this)}on(e,n,r){return this.addEventListener(e,n,r)}off(e,n,r){return this.ws.removeEventListener(e,n,r),this}subscribe(e,n){return this.addEventListener("message",e,n)}addEventListener(e,n,r){return this.ws.addEventListener(e,s=>{if(e==="message"){let i=K(s);n({...s,data:i})}else n(s)},r),this}removeEventListener(e,n,r){return this.off(e,n,r),this}close(){return this.ws.close(),this}},D=(t,e="",n)=>new Proxy(()=>{},{get(r,s,i){return D(t,`${e}/${s.toString()}`,n)},apply(r,s,[i,w={}]=[{},{}]){let c=i!==void 0&&(typeof i!="object"||Array.isArray(i))?i:void 0,{$query:I,$fetch:R,$headers:P,$transform:g,getRaw:C,...J}=i??{};c??=J;let x=e.lastIndexOf("/"),m=e.slice(x+1).toUpperCase(),A=L(t,x===-1?"/":e.slice(0,x),Object.assign(w.query??{},I)),q=n.fetcher??fetch,y=n.transform?Array.isArray(n.transform)?n.transform:[n.transform]:void 0,T=g?Array.isArray(g)?g:[g]:void 0;return T&&(y?y=T.concat(y):y=T),m==="SUBSCRIBE"?new b(A.replace(/^([^]+):\/\//,A.startsWith("https://")?"wss://":"ws://")):(async V=>{let a,W={...n.$fetch?.headers,...R?.headers,...w.headers,...P};if(m!=="GET"&&m!=="HEAD"){a=Object.keys(c).length||Array.isArray(c)?c:void 0;let l=a&&(typeof a=="object"||Array.isArray(c));if(l&&re(a)){let p=new FormData;for(let[h,d]of Object.entries(a))if(M)p.append(h,d);else if(d instanceof File)p.append(h,await F(d));else if(d instanceof FileList)for(let u=0;u<d.length;u++)p.append(h,await F(d[u]));else if(Array.isArray(d))for(let u=0;u<d.length;u++){let O=d[u];p.append(h,O instanceof File?await F(O):O)}else p.append(h,d);a=p}else a!=null&&(W["content-type"]=l?"application/json":"text/plain",a=l?JSON.stringify(a):c)}let o=await q(A,{method:m,body:a,...n.$fetch,...w.fetch,...R,headers:W}),E;if(V.getRaw)return o;switch(o.headers.get("Content-Type")?.split(";")[0]){case"application/json":E=await o.json();break;default:E=await o.text().then($)}let Z=o.status>=300||o.status<200?new S(o.status,E):null,k={data:E,error:Z,response:o,status:o.status,headers:o.headers};if(y)for(let l of y){let f=l(k);f instanceof Promise&&(f=await f),f!=null&&(k=f)}return k})({getRaw:C})}}),se=(t,e={fetcher:fetch})=>new Proxy({},{get(n,r){return D(t,r,e)}});return z(ae);})();
+"use strict";var Eden=(()=>{var N=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var Q=(n,e)=>{for(var t in e)N(n,t,{get:e[t],enumerable:!0})},X=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of _(e))!z.call(n,s)&&s!==t&&N(n,s,{get:()=>e[s],enumerable:!(r=U(e,s))||r.enumerable});return n};var Y=n=>X(N({},"__esModule",{value:!0}),n);var oe={};Q(oe,{EdenWS:()=>j,edenTreaty:()=>ie});var v=class extends Error{constructor(t,r){super(r+"");this.status=t;this.value=r}};var P=(n,e,t)=>{if(n.endsWith("/")||(n+="/"),e==="index"&&(e=""),!t||!Object.keys(t).length)return`${n}${e}`;let r="";for(let[s,a]of Object.entries(t))r+=`${s}=${a}&`;return`${n}${e}?${r.slice(0,-1)}`};var ee=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,te=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,ne=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,se=n=>n.trim().length!==0&&!Number.isNaN(Number(n)),I=n=>{if(typeof n!="string")return null;let e=n.replace(/"/g,"");if(ee.test(e)||te.test(e)||ne.test(e)){let t=new Date(e);if(!Number.isNaN(t.getTime()))return t}return null},re=n=>{let e=n.charCodeAt(0),t=n.charCodeAt(n.length-1);return e===123&&t===125||e===91&&t===93},ae=n=>JSON.parse(n,(e,t)=>{let r=I(t);return r||t}),K=n=>{if(!n)return n;if(se(n))return+n;if(n==="true")return!0;if(n==="false")return!1;let e=I(n);if(e)return e;if(re(n))try{return ae(n)}catch{}return n},C=n=>{let e=n.data.toString();return e==="null"?null:K(e)};var O=typeof FileList>"u",y=n=>O?n instanceof Blob:n instanceof FileList||n instanceof File,g=n=>{if(!n)return!1;for(let e in n){let t=n[e];if(y(t))return!0;if(Array.isArray(t)){for(let r of t)if(y(r)||typeof r=="object"&&r!==null&&g(r))return!0}if(typeof t=="object"&&t!==null&&!(t instanceof Date)&&g(t))return!0}return!1},L=(n,e)=>{let t={},r=[];for(let[s,a]of Object.entries(n))if(y(a))r.push({key:`${e}.${s}`,value:a});else if(Array.isArray(a))if(a.some(i=>y(i)||typeof i=="object"&&i!==null&&g(i)))for(let i=0;i<a.length;i++){let o=a[i];if(y(o))r.push({key:`${e}.${s}`,value:o});else if(typeof o=="object"&&o!==null&&g(o)){let c=L(o,`${e}.${s}[${i}]`);Object.keys(c.nonFileData).length>0&&r.push({key:`${e}.${s}[${i}]`,value:JSON.stringify(c.nonFileData)}),r.push(...c.files)}else typeof o=="object"&&o!==null?r.push({key:`${e}.${s}[${i}]`,value:JSON.stringify(o)}):r.push({key:`${e}.${s}[${i}]`,value:o})}else t[s]=a;else if(typeof a=="object"&&a!==null&&!(a instanceof Date))if(g(a)){let u=L(a,`${e}.${s}`);Object.keys(u.nonFileData).length>0&&(t[s]=u.nonFileData),r.push(...u.files)}else t[s]=a;else t[s]=a;return{nonFileData:t,files:r}},H=(n,e="")=>{let t={};for(let[r,s]of Object.entries(n)){let a=e?`${e}.${r}`:r;if(y(s))t[a]=s;else if(Array.isArray(s))if(s.some(i=>y(i)||typeof i=="object"&&i!==null&&g(i)))if(s.every(o=>y(o)))t[a]=s;else for(let o=0;o<s.length;o++){let c=s[o],h=`${a}[${o}]`;if(y(c))t[h]=c;else if(typeof c=="object"&&c!==null&&!(c instanceof Date))if(g(c)){let{nonFileData:b,files:T}=L(c,h);Object.keys(b).length>0&&(t[h]=JSON.stringify(b));for(let{key:x,value:A}of T)t[x]=A}else t[h]=JSON.stringify(c);else t[h]=c}else t[a]=JSON.stringify(s);else typeof s=="object"&&s!==null&&!(s instanceof Date)?g(s)?Object.assign(t,H(s,a)):t[a]=JSON.stringify(s):t[a]=s}return t},W=n=>O?n:new Promise(e=>{let t=new FileReader;t.onload=()=>{let r=new File([t.result],n.name,{lastModified:n.lastModified,type:n.type});e(r)},t.readAsArrayBuffer(n)}),j=class{ws;url;constructor(e){this.ws=new WebSocket(e),this.url=e}send(e){return Array.isArray(e)?(e.forEach(t=>this.send(t)),this):(this.ws.send(typeof e=="object"?JSON.stringify(e):e.toString()),this)}on(e,t,r){return this.addEventListener(e,t,r)}off(e,t,r){return this.ws.removeEventListener(e,t,r),this}subscribe(e,t){return this.addEventListener("message",e,t)}addEventListener(e,t,r){return this.ws.addEventListener(e,s=>{if(e==="message"){let a=C(s);t({...s,data:a})}else t(s)},r),this}removeEventListener(e,t,r){return this.off(e,t,r),this}close(){return this.ws.close(),this}},q=(n,e="",t)=>new Proxy(()=>{},{get(r,s,a){return q(n,`${e}/${s.toString()}`,t)},apply(r,s,[a,u={}]=[{},{}]){let i=a!==void 0&&(typeof a!="object"||Array.isArray(a))?a:void 0,{$query:o,$fetch:c,$headers:h,$transform:b,getRaw:T,...x}=a??{};i??=x;let A=e.lastIndexOf("/"),w=e.slice(A+1).toUpperCase(),R=P(n,A===-1?"/":e.slice(0,A),Object.assign(u.query??{},o)),V=t.fetcher??fetch,E=t.transform?Array.isArray(t.transform)?t.transform:[t.transform]:void 0,D=b?Array.isArray(b)?b:[b]:void 0;return D&&(E?E=D.concat(E):E=D),w==="SUBSCRIBE"?new j(R.replace(/^([^]+):\/\//,R.startsWith("https://")?"wss://":"ws://")):(async Z=>{let f,J={...t.$fetch?.headers,...c?.headers,...u.headers,...h};if(w!=="GET"&&w!=="HEAD"){f=Object.keys(i).length||Array.isArray(i)?i:void 0;let k=f&&(typeof f=="object"||Array.isArray(i));if(k&&g(f)){let S=new FormData,G=H(f);for(let[$,l]of Object.entries(G))if(Array.isArray(l))for(let p of l)p instanceof File?S.append($,O?p:await W(p)):y(p)&&S.append($,p);else if(l instanceof File)S.append($,O?l:await W(l));else if(!O&&l instanceof FileList)for(let p=0;p<l.length;p++)S.append($,await W(l[p]));else y(l),S.append($,l);f=S}else f!=null&&(J["content-type"]=k?"application/json":"text/plain",f=k?JSON.stringify(f):i)}let d=await V(R,{method:w,body:f,...t.$fetch,...u.fetch,...c,headers:J}),F;if(Z.getRaw)return d;d.headers.get("Content-Type")?.split(";")[0]==="application/json"?F=await d.json():F=await d.text().then(K);let B=d.status>=300||d.status<200?new v(d.status,F):null,M={data:F,error:B,response:d,status:d.status,headers:d.headers};if(E)for(let k of E){let m=k(M);m instanceof Promise&&(m=await m),m!=null&&(M=m)}return M})({getRaw:T})}}),ie=(n,e={fetcher:fetch})=>new Proxy({},{get(t,r){return q(n,r,e)}});return Y(oe);})();
diff --git a/dist/treaty.js b/dist/treaty.js
index 21d9d4bc99138135f668ae004888d0508ee5567a..a29cc16d05687009cd8acaf9f890319d040f020a 100644
--- a/dist/treaty.js
+++ b/dist/treaty.js
@@ -1 +1 @@
-"use strict";var v=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var U=(t,e)=>{for(var n in e)v(t,n,{get:e[n],enumerable:!0})},_=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of G(e))!H.call(t,s)&&s!==n&&v(t,s,{get:()=>e[s],enumerable:!(r=B(e,s))||r.enumerable});return t};var z=t=>_(v({},"__esModule",{value:!0}),t);var ae={};U(ae,{EdenWS:()=>b,edenTreaty:()=>se});module.exports=z(ae);var S=class extends Error{constructor(n,r){super(r+"");this.status=n;this.value=r}};var L=(t,e,n)=>{if(t.endsWith("/")||(t+="/"),e==="index"&&(e=""),!n||!Object.keys(n).length)return`${t}${e}`;let r="";for(let[s,i]of Object.entries(n))r+=`${s}=${i}&`;return`${t}${e}?${r.slice(0,-1)}`};var Q=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,X=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,Y=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,ee=t=>t.trim().length!==0&&!Number.isNaN(Number(t)),N=t=>{if(typeof t!="string")return null;let e=t.replace(/"/g,"");if(Q.test(e)||X.test(e)||Y.test(e)){let n=new Date(e);if(!Number.isNaN(n.getTime()))return n}return null},te=t=>{let e=t.charCodeAt(0),n=t.charCodeAt(t.length-1);return e===123&&n===125||e===91&&n===93},ne=t=>JSON.parse(t,(e,n)=>{let r=N(n);return r||n}),$=t=>{if(!t)return t;if(ee(t))return+t;if(t==="true")return!0;if(t==="false")return!1;let e=N(t);if(e)return e;if(te(t))try{return ne(t)}catch{}return t},K=t=>{let e=t.data.toString();return e==="null"?null:$(e)};var M=typeof FileList>"u",j=t=>M?t instanceof Blob:t instanceof FileList||t instanceof File,re=t=>{if(!t)return!1;for(let e in t){if(j(t[e]))return!0;if(Array.isArray(t[e])&&t[e].find(n=>j(n)))return!0}return!1},F=t=>M?t:new Promise(e=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],t.name,{lastModified:t.lastModified,type:t.type});e(r)},n.readAsArrayBuffer(t)}),b=class{ws;url;constructor(e){this.ws=new WebSocket(e),this.url=e}send(e){return Array.isArray(e)?(e.forEach(n=>this.send(n)),this):(this.ws.send(typeof e=="object"?JSON.stringify(e):e.toString()),this)}on(e,n,r){return this.addEventListener(e,n,r)}off(e,n,r){return this.ws.removeEventListener(e,n,r),this}subscribe(e,n){return this.addEventListener("message",e,n)}addEventListener(e,n,r){return this.ws.addEventListener(e,s=>{if(e==="message"){let i=K(s);n({...s,data:i})}else n(s)},r),this}removeEventListener(e,n,r){return this.off(e,n,r),this}close(){return this.ws.close(),this}},D=(t,e="",n)=>new Proxy(()=>{},{get(r,s,i){return D(t,`${e}/${s.toString()}`,n)},apply(r,s,[i,w={}]=[{},{}]){let c=i!==void 0&&(typeof i!="object"||Array.isArray(i))?i:void 0,{$query:I,$fetch:R,$headers:P,$transform:g,getRaw:C,...J}=i??{};c??=J;let x=e.lastIndexOf("/"),m=e.slice(x+1).toUpperCase(),A=L(t,x===-1?"/":e.slice(0,x),Object.assign(w.query??{},I)),q=n.fetcher??fetch,y=n.transform?Array.isArray(n.transform)?n.transform:[n.transform]:void 0,T=g?Array.isArray(g)?g:[g]:void 0;return T&&(y?y=T.concat(y):y=T),m==="SUBSCRIBE"?new b(A.replace(/^([^]+):\/\//,A.startsWith("https://")?"wss://":"ws://")):(async V=>{let a,W={...n.$fetch?.headers,...R?.headers,...w.headers,...P};if(m!=="GET"&&m!=="HEAD"){a=Object.keys(c).length||Array.isArray(c)?c:void 0;let l=a&&(typeof a=="object"||Array.isArray(c));if(l&&re(a)){let p=new FormData;for(let[h,d]of Object.entries(a))if(M)p.append(h,d);else if(d instanceof File)p.append(h,await F(d));else if(d instanceof FileList)for(let u=0;u<d.length;u++)p.append(h,await F(d[u]));else if(Array.isArray(d))for(let u=0;u<d.length;u++){let O=d[u];p.append(h,O instanceof File?await F(O):O)}else p.append(h,d);a=p}else a!=null&&(W["content-type"]=l?"application/json":"text/plain",a=l?JSON.stringify(a):c)}let o=await q(A,{method:m,body:a,...n.$fetch,...w.fetch,...R,headers:W}),E;if(V.getRaw)return o;switch(o.headers.get("Content-Type")?.split(";")[0]){case"application/json":E=await o.json();break;default:E=await o.text().then($)}let Z=o.status>=300||o.status<200?new S(o.status,E):null,k={data:E,error:Z,response:o,status:o.status,headers:o.headers};if(y)for(let l of y){let f=l(k);f instanceof Promise&&(f=await f),f!=null&&(k=f)}return k})({getRaw:C})}}),se=(t,e={fetcher:fetch})=>new Proxy({},{get(n,r){return D(t,r,e)}});0&&(module.exports={EdenWS,edenTreaty});
+"use strict";var N=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var Q=(n,e)=>{for(var t in e)N(n,t,{get:e[t],enumerable:!0})},X=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of _(e))!z.call(n,s)&&s!==t&&N(n,s,{get:()=>e[s],enumerable:!(r=U(e,s))||r.enumerable});return n};var Y=n=>X(N({},"__esModule",{value:!0}),n);var oe={};Q(oe,{EdenWS:()=>j,edenTreaty:()=>ie});module.exports=Y(oe);var v=class extends Error{constructor(t,r){super(r+"");this.status=t;this.value=r}};var P=(n,e,t)=>{if(n.endsWith("/")||(n+="/"),e==="index"&&(e=""),!t||!Object.keys(t).length)return`${n}${e}`;let r="";for(let[s,a]of Object.entries(t))r+=`${s}=${a}&`;return`${n}${e}?${r.slice(0,-1)}`};var ee=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,te=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,ne=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,se=n=>n.trim().length!==0&&!Number.isNaN(Number(n)),I=n=>{if(typeof n!="string")return null;let e=n.replace(/"/g,"");if(ee.test(e)||te.test(e)||ne.test(e)){let t=new Date(e);if(!Number.isNaN(t.getTime()))return t}return null},re=n=>{let e=n.charCodeAt(0),t=n.charCodeAt(n.length-1);return e===123&&t===125||e===91&&t===93},ae=n=>JSON.parse(n,(e,t)=>{let r=I(t);return r||t}),K=n=>{if(!n)return n;if(se(n))return+n;if(n==="true")return!0;if(n==="false")return!1;let e=I(n);if(e)return e;if(re(n))try{return ae(n)}catch{}return n},C=n=>{let e=n.data.toString();return e==="null"?null:K(e)};var O=typeof FileList>"u",y=n=>O?n instanceof Blob:n instanceof FileList||n instanceof File,g=n=>{if(!n)return!1;for(let e in n){let t=n[e];if(y(t))return!0;if(Array.isArray(t)){for(let r of t)if(y(r)||typeof r=="object"&&r!==null&&g(r))return!0}if(typeof t=="object"&&t!==null&&!(t instanceof Date)&&g(t))return!0}return!1},L=(n,e)=>{let t={},r=[];for(let[s,a]of Object.entries(n))if(y(a))r.push({key:`${e}.${s}`,value:a});else if(Array.isArray(a))if(a.some(i=>y(i)||typeof i=="object"&&i!==null&&g(i)))for(let i=0;i<a.length;i++){let o=a[i];if(y(o))r.push({key:`${e}.${s}`,value:o});else if(typeof o=="object"&&o!==null&&g(o)){let c=L(o,`${e}.${s}[${i}]`);Object.keys(c.nonFileData).length>0&&r.push({key:`${e}.${s}[${i}]`,value:JSON.stringify(c.nonFileData)}),r.push(...c.files)}else typeof o=="object"&&o!==null?r.push({key:`${e}.${s}[${i}]`,value:JSON.stringify(o)}):r.push({key:`${e}.${s}[${i}]`,value:o})}else t[s]=a;else if(typeof a=="object"&&a!==null&&!(a instanceof Date))if(g(a)){let u=L(a,`${e}.${s}`);Object.keys(u.nonFileData).length>0&&(t[s]=u.nonFileData),r.push(...u.files)}else t[s]=a;else t[s]=a;return{nonFileData:t,files:r}},H=(n,e="")=>{let t={};for(let[r,s]of Object.entries(n)){let a=e?`${e}.${r}`:r;if(y(s))t[a]=s;else if(Array.isArray(s))if(s.some(i=>y(i)||typeof i=="object"&&i!==null&&g(i)))if(s.every(o=>y(o)))t[a]=s;else for(let o=0;o<s.length;o++){let c=s[o],h=`${a}[${o}]`;if(y(c))t[h]=c;else if(typeof c=="object"&&c!==null&&!(c instanceof Date))if(g(c)){let{nonFileData:b,files:T}=L(c,h);Object.keys(b).length>0&&(t[h]=JSON.stringify(b));for(let{key:x,value:A}of T)t[x]=A}else t[h]=JSON.stringify(c);else t[h]=c}else t[a]=JSON.stringify(s);else typeof s=="object"&&s!==null&&!(s instanceof Date)?g(s)?Object.assign(t,H(s,a)):t[a]=JSON.stringify(s):t[a]=s}return t},W=n=>O?n:new Promise(e=>{let t=new FileReader;t.onload=()=>{let r=new File([t.result],n.name,{lastModified:n.lastModified,type:n.type});e(r)},t.readAsArrayBuffer(n)}),j=class{ws;url;constructor(e){this.ws=new WebSocket(e),this.url=e}send(e){return Array.isArray(e)?(e.forEach(t=>this.send(t)),this):(this.ws.send(typeof e=="object"?JSON.stringify(e):e.toString()),this)}on(e,t,r){return this.addEventListener(e,t,r)}off(e,t,r){return this.ws.removeEventListener(e,t,r),this}subscribe(e,t){return this.addEventListener("message",e,t)}addEventListener(e,t,r){return this.ws.addEventListener(e,s=>{if(e==="message"){let a=C(s);t({...s,data:a})}else t(s)},r),this}removeEventListener(e,t,r){return this.off(e,t,r),this}close(){return this.ws.close(),this}},q=(n,e="",t)=>new Proxy(()=>{},{get(r,s,a){return q(n,`${e}/${s.toString()}`,t)},apply(r,s,[a,u={}]=[{},{}]){let i=a!==void 0&&(typeof a!="object"||Array.isArray(a))?a:void 0,{$query:o,$fetch:c,$headers:h,$transform:b,getRaw:T,...x}=a??{};i??=x;let A=e.lastIndexOf("/"),w=e.slice(A+1).toUpperCase(),R=P(n,A===-1?"/":e.slice(0,A),Object.assign(u.query??{},o)),V=t.fetcher??fetch,E=t.transform?Array.isArray(t.transform)?t.transform:[t.transform]:void 0,D=b?Array.isArray(b)?b:[b]:void 0;return D&&(E?E=D.concat(E):E=D),w==="SUBSCRIBE"?new j(R.replace(/^([^]+):\/\//,R.startsWith("https://")?"wss://":"ws://")):(async Z=>{let f,J={...t.$fetch?.headers,...c?.headers,...u.headers,...h};if(w!=="GET"&&w!=="HEAD"){f=Object.keys(i).length||Array.isArray(i)?i:void 0;let k=f&&(typeof f=="object"||Array.isArray(i));if(k&&g(f)){let S=new FormData,G=H(f);for(let[$,l]of Object.entries(G))if(Array.isArray(l))for(let p of l)p instanceof File?S.append($,O?p:await W(p)):y(p)&&S.append($,p);else if(l instanceof File)S.append($,O?l:await W(l));else if(!O&&l instanceof FileList)for(let p=0;p<l.length;p++)S.append($,await W(l[p]));else y(l),S.append($,l);f=S}else f!=null&&(J["content-type"]=k?"application/json":"text/plain",f=k?JSON.stringify(f):i)}let d=await V(R,{method:w,body:f,...t.$fetch,...u.fetch,...c,headers:J}),F;if(Z.getRaw)return d;d.headers.get("Content-Type")?.split(";")[0]==="application/json"?F=await d.json():F=await d.text().then(K);let B=d.status>=300||d.status<200?new v(d.status,F):null,M={data:F,error:B,response:d,status:d.status,headers:d.headers};if(E)for(let k of E){let m=k(M);m instanceof Promise&&(m=await m),m!=null&&(M=m)}return M})({getRaw:T})}}),ie=(n,e={fetcher:fetch})=>new Proxy({},{get(t,r){return q(n,r,e)}});0&&(module.exports={EdenWS,edenTreaty});
diff --git a/dist/treaty.mjs b/dist/treaty.mjs
index b29d8ee76772c465a898f5bdb96237ef92cc8c1d..292e0e4479c553d4333c18948464727a3908ea6c 100644
--- a/dist/treaty.mjs
+++ b/dist/treaty.mjs
@@ -1 +1 @@
-import{a,b}from"./chunk-EF6Z4LSD.mjs";import"./chunk-QSLHAOSM.mjs";export{a as EdenWS,b as edenTreaty};
+import{a,b}from"./chunk-F3GV6FPC.mjs";import"./chunk-QSLHAOSM.mjs";export{a as EdenWS,b as edenTreaty};
diff --git a/dist/treaty2/types.d.ts b/dist/treaty2/types.d.ts
index fd5f41654f1713924690af40b69ff05927e02f8e..f08656b6d5c3b725ed4d31fb96ea9ffc30042f99 100644
--- a/dist/treaty2/types.d.ts
+++ b/dist/treaty2/types.d.ts
@@ -10,9 +10,12 @@ type Enumerate<N extends number, Acc extends number[] = []> = Acc['length'] exte
 type IntegerRange<F extends number, T extends number> = Exclude<Enumerate<T>, Enumerate<F>>;
 type SuccessCodeRange = IntegerRange<200, 300>;
 type MaybeArray<T> = T | T[];
-type MaybeArrayFile<T> = T extends (File | BunFile)[] ? (File | BunFile)[] | File | BunFile : T extends File | BunFile ? File | BunFile : T;
-type RelaxFileArrays<T> = T extends Record<string, unknown> ? {
-    [K in keyof T]: MaybeArrayFile<T[K]>;
+/**
+ * Recursively transforms File types to accept both File and BunFile.
+ * This allows using Bun.file() in nested objects and arrays.
+ */
+type RelaxFileArrays<T> = T extends (File | BunFile)[] ? (File | BunFile)[] | File | BunFile : T extends File | BunFile ? File | BunFile : T extends Array<infer U> ? Array<RelaxFileArrays<U>> : T extends Record<string, unknown> ? {
+    [K in keyof T]: RelaxFileArrays<T[K]>;
 } : T;
 type SerializeQueryParams<T> = T extends Record<string, any> ? {
     [K in keyof T]: T[K] extends Date ? string : T[K] extends Date | undefined ? string | undefined : T[K];
diff --git a/dist/treaty2.d.mts b/dist/treaty2.d.mts
index 62aef1733d2501d6e7bbedd077ffc131b38f7672..df7b238441b8b7621665795bdc9d1a8230714d87 100644
--- a/dist/treaty2.d.mts
+++ b/dist/treaty2.d.mts
@@ -23,9 +23,12 @@ type Enumerate<N extends number, Acc extends number[] = []> = Acc['length'] exte
 type IntegerRange<F extends number, T extends number> = Exclude<Enumerate<T>, Enumerate<F>>;
 type SuccessCodeRange = IntegerRange<200, 300>;
 type MaybeArray<T> = T | T[];
-type MaybeArrayFile<T> = T extends (File | BunFile)[] ? (File | BunFile)[] | File | BunFile : T extends File | BunFile ? File | BunFile : T;
-type RelaxFileArrays<T> = T extends Record<string, unknown> ? {
-    [K in keyof T]: MaybeArrayFile<T[K]>;
+/**
+ * Recursively transforms File types to accept both File and BunFile.
+ * This allows using Bun.file() in nested objects and arrays.
+ */
+type RelaxFileArrays<T> = T extends (File | BunFile)[] ? (File | BunFile)[] | File | BunFile : T extends File | BunFile ? File | BunFile : T extends Array<infer U> ? Array<RelaxFileArrays<U>> : T extends Record<string, unknown> ? {
+    [K in keyof T]: RelaxFileArrays<T[K]>;
 } : T;
 type SerializeQueryParams<T> = T extends Record<string, any> ? {
     [K in keyof T]: T[K] extends Date ? string : T[K] extends Date | undefined ? string | undefined : T[K];
diff --git a/dist/treaty2.d.ts b/dist/treaty2.d.ts
index 4ce15efe0e1c09504408312b4976ea49b2dc033a..3e22dba9a90e728b72b62163dfd17bc9f36fc564 100644
--- a/dist/treaty2.d.ts
+++ b/dist/treaty2.d.ts
@@ -23,9 +23,12 @@ type Enumerate<N extends number, Acc extends number[] = []> = Acc['length'] exte
 type IntegerRange<F extends number, T extends number> = Exclude<Enumerate<T>, Enumerate<F>>;
 type SuccessCodeRange = IntegerRange<200, 300>;
 type MaybeArray<T> = T | T[];
-type MaybeArrayFile<T> = T extends (File | BunFile)[] ? (File | BunFile)[] | File | BunFile : T extends File | BunFile ? File | BunFile : T;
-type RelaxFileArrays<T> = T extends Record<string, unknown> ? {
-    [K in keyof T]: MaybeArrayFile<T[K]>;
+/**
+ * Recursively transforms File types to accept both File and BunFile.
+ * This allows using Bun.file() in nested objects and arrays.
+ */
+type RelaxFileArrays<T> = T extends (File | BunFile)[] ? (File | BunFile)[] | File | BunFile : T extends File | BunFile ? File | BunFile : T extends Array<infer U> ? Array<RelaxFileArrays<U>> : T extends Record<string, unknown> ? {
+    [K in keyof T]: RelaxFileArrays<T[K]>;
 } : T;
 type SerializeQueryParams<T> = T extends Record<string, any> ? {
     [K in keyof T]: T[K] extends Date ? string : T[K] extends Date | undefined ? string | undefined : T[K];
diff --git a/dist/treaty2.global.js b/dist/treaty2.global.js
index 50e1b591eaf7c8d635721ac07c9e8c8fe8a7da30..28e6efa765260d953817f8549dc77bbe7d51f2be 100644
--- a/dist/treaty2.global.js
+++ b/dist/treaty2.global.js
@@ -1,4 +1,4 @@
-"use strict";var Eden=(()=>{var D=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var Q=Object.prototype.hasOwnProperty;var X=(e,t)=>{for(var n in t)D(e,n,{get:t[n],enumerable:!0})},Y=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of z(t))!Q.call(e,i)&&i!==n&&D(e,i,{get:()=>t[i],enumerable:!(r=Z(t,i))||r.enumerable});return e};var ee=e=>Y(D({},"__esModule",{value:!0}),e);var ue={};X(ue,{streamResponse:()=>_,treaty:()=>fe});var k=class extends Error{constructor(n,r){super(r+"");this.status=n;this.value=r}};var te=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,ne=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,re=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,se=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),T=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(te.test(t)||ne.test(t)||re.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},ie=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},ae=e=>JSON.parse(e,(t,n)=>{let r=T(n);return r||n}),W=e=>{if(!e)return e;if(se(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=T(e);if(t)return t;if(ie(e))try{return ae(e)}catch{}return e},q=e=>{let t=e.data.toString();return t==="null"?null:W(t)};var M=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,i=>{if(t==="message"){let u=q(i);n({...i,data:u})}else n(i)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}};var oe=["get","post","put","delete","patch","options","head","connect","subscribe"],V=["localhost","127.0.0.1","0.0.0.0"],J=typeof FileList>"u",C=e=>J?e instanceof Blob:e instanceof FileList||e instanceof File,ce=e=>{if(!e)return!1;for(let t in e)if(C(e[t])||Array.isArray(e[t])&&e[t].find(C))return!0;return!1},K=e=>J?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),E=async(e,t,n={},r={})=>{if(Array.isArray(e)){for(let i of e)if(!Array.isArray(i))r=await E(i,t,n,r);else{let u=i[0];if(typeof u=="string")r[u.toLowerCase()]=i[1];else for(let[a,y]of u)r[a.toLowerCase()]=y}return r}if(!e)return r;switch(typeof e){case"function":if(e instanceof Headers)return E(e,t,n,r);let i=await e(t,n);return i?E(i,t,n,r):r;case"object":if(e instanceof Headers)return e.forEach((u,a)=>{r[a.toLowerCase()]=u}),r;for(let[u,a]of Object.entries(e))r[u.toLowerCase()]=a;return r;default:return r}};function B(e){let t=e.split(`
-`),n={};for(let r of t){if(!r||r.startsWith(":"))continue;let i=r.indexOf(":");if(i>0){let u=r.slice(0,i).trim(),a=r.slice(i+1).replace(/^ /,"");n[u]=a&&W(a)}}return Object.keys(n).length>0?n:null}function*P(e){let t;for(;(t=e.value.indexOf(`
+"use strict";var Eden=(()=>{var K=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var Q=(e,t)=>{for(var n in t)K(e,n,{get:t[n],enumerable:!0})},X=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Z(t))!z.call(e,r)&&r!==n&&K(e,r,{get:()=>t[r],enumerable:!(s=G(t,r))||s.enumerable});return e};var Y=e=>X(K({},"__esModule",{value:!0}),e);var ce={};Q(ce,{streamResponse:()=>_,treaty:()=>oe});var j=class extends Error{constructor(n,s){super(s+"");this.status=n;this.value=s}};var ee=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,te=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,ne=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,se=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),T=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(ee.test(t)||te.test(t)||ne.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},re=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},ie=e=>JSON.parse(e,(t,n)=>{let s=T(n);return s||n}),W=e=>{if(!e)return e;if(se(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=T(e);if(t)return t;if(re(e))try{return ie(e)}catch{}return e},q=e=>{let t=e.data.toString();return t==="null"?null:W(t)};var M=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,s){return this.addEventListener(t,n,s)}off(t,n,s){return this.ws.removeEventListener(t,n,s),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,s){return this.ws.addEventListener(t,r=>{if(t==="message"){let i=q(r);n({...r,data:i})}else n(r)},s),this}removeEventListener(t,n,s){return this.off(t,n,s),this}close(){return this.ws.close(),this}};var ae=["get","post","put","delete","patch","options","head","connect","subscribe"],P=["localhost","127.0.0.1","0.0.0.0"],R=typeof FileList>"u",m=e=>R?e instanceof Blob:e instanceof FileList||e instanceof File,A=e=>{if(!e)return!1;for(let t in e){let n=e[t];if(m(n))return!0;if(Array.isArray(n)){for(let s of n)if(m(s)||typeof s=="object"&&s!==null&&A(s))return!0}else if(typeof n=="object"&&n!==null&&!(n instanceof Date)&&A(n))return!0}return!1},J=(e,t)=>{let n={},s=[];for(let[r,i]of Object.entries(e))if(m(i))s.push({key:`${t}.${r}`,value:i});else if(Array.isArray(i))if(i.some(o=>m(o)||typeof o=="object"&&o!==null&&A(o)))for(let o=0;o<i.length;o++){let f=i[o];if(m(f))s.push({key:`${t}.${r}[${o}]`,value:f});else if(typeof f=="object"&&f!==null&&A(f)){let u=J(f,`${t}.${r}[${o}]`);Object.keys(u.nonFileData).length>0&&s.push({key:`${t}.${r}[${o}]`,value:JSON.stringify(u.nonFileData)}),s.push(...u.files)}else typeof f=="object"&&f!==null?s.push({key:`${t}.${r}[${o}]`,value:JSON.stringify(f)}):s.push({key:`${t}.${r}[${o}]`,value:f})}else n[r]=i;else if(typeof i=="object"&&i!==null&&!(i instanceof Date))if(A(i)){let a=J(i,`${t}.${r}`);Object.keys(a.nonFileData).length>0&&(n[r]=a.nonFileData),s.push(...a.files)}else n[r]=i;else n[r]=i;return{nonFileData:n,files:s}},B=(e,t="")=>{let n={};for(let[s,r]of Object.entries(e)){let i=t?`${t}.${s}`:s;if(m(r))n[i]=r;else if(Array.isArray(r))if(r.some(o=>m(o)||typeof o=="object"&&o!==null&&A(o)))if(r.every(f=>m(f)))for(let f=0;f<r.length;f++)n[`${i}[${f}]`]=r[f];else for(let f=0;f<r.length;f++){let u=r[f],p=`${i}[${f}]`;if(m(u))n[p]=u;else if(typeof u=="object"&&u!==null&&!(u instanceof Date))if(A(u)){let{nonFileData:N,files:F}=J(u,p);Object.keys(N).length>0&&(n[p]=JSON.stringify(N));for(let{key:b,value:O}of F)n[b]=O}else n[p]=JSON.stringify(u);else n[p]=u}else n[i]=JSON.stringify(r);else typeof r=="object"&&r!==null&&!(r instanceof Date)?A(r)?Object.assign(n,B(r,i)):n[i]=JSON.stringify(r):n[i]=r}return n},C=e=>R?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let s=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(s)},n.readAsArrayBuffer(e)}),E=async(e,t,n={},s={})=>{if(Array.isArray(e)){for(let r of e)if(!Array.isArray(r))s=await E(r,t,n,s);else{let i=r[0];if(typeof i=="string")s[i.toLowerCase()]=r[1];else for(let[a,o]of i)s[a.toLowerCase()]=o}return s}if(!e)return s;switch(typeof e){case"function":if(e instanceof Headers)return E(e,t,n,s);let r=await e(t,n);return r?E(r,t,n,s):s;case"object":if(e instanceof Headers)return e.forEach((i,a)=>{s[a.toLowerCase()]=i}),s;for(let[i,a]of Object.entries(e))s[i.toLowerCase()]=a;return s;default:return s}};function V(e){let t=e.split(`
+`),n={};for(let s of t){if(!s||s.startsWith(":"))continue;let r=s.indexOf(":");if(r>0){let i=s.slice(0,r).trim(),a=s.slice(r+1).replace(/^ /,"");n[i]=a&&W(a)}}return Object.keys(n).length>0?n:null}function*H(e){let t;for(;(t=e.value.indexOf(`
 
-`))!==-1;){let n=e.value.slice(0,t);if(e.value=e.value.slice(t+2),n.trim()){let r=B(n);r&&(yield r)}}}async function*_(e){let t=e.body;if(!t)return;let n=t.getReader(),r=new TextDecoder("utf-8"),i={value:""};try{for(;;){let{done:a,value:y}=await n.read();if(a)break;let R=typeof y=="string"?y:r.decode(y,{stream:!0});i.value+=R,yield*P(i)}let u=r.decode();if(u&&(i.value+=u),yield*P(i),i.value.trim()){let a=B(i.value);a&&(yield a)}}finally{n.releaseLock()}}var F=(e,t,n=[],r)=>new Proxy(()=>{},{get(i,u){return F(e,t,u==="index"?n:[...n,u],r)},apply(i,u,[a,y]){if(!a||y||typeof a=="object"&&Object.keys(a).length!==1||oe.includes(n.at(-1))){let R=[...n],x=R.pop(),m="/"+R.join("/"),{fetcher:H=fetch,headers:L,onRequest:w,onResponse:O,fetch:U}=t,v=x==="get"||x==="head"||x==="subscribe",I=v?a?.query:y?.query,N="";if(I){let s=(b,p)=>{N+=(N?"&":"?")+`${encodeURIComponent(b)}=${encodeURIComponent(p)}`};for(let[b,p]of Object.entries(I)){if(Array.isArray(p)){for(let f of p)s(b,f);continue}if(p!=null){if(typeof p=="object"){s(b,JSON.stringify(p));continue}s(b,`${p}`)}}}if(x==="subscribe"){let s=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||V.find(b=>e.includes(b))?"ws://":"wss://")+m+N;return new M(s)}return(async()=>{L=await E(L,m,y);let s={method:x?.toUpperCase(),body:a,...U,headers:L};s.headers={...L,...await E(v?a?.headers:y?.headers,m,s)};let b=v&&typeof a=="object"?a.fetch:y?.fetch;if(s={...s,...b},v&&delete s.body,w){Array.isArray(w)||(w=[w]);for(let d of w){let c=await d(m,s);typeof c=="object"&&(s={...s,...c,headers:{...s.headers,...await E(c.headers,m,s)}})}}if(v&&delete s.body,ce(a)){let d=new FormData,c=o=>{if(typeof o=="string"||C(o))return!1;if(typeof o=="object"){if(o!==null)return!0;if(o instanceof Date)return!1}return!1},h=async o=>o instanceof File?await K(o):c(o)?JSON.stringify(o):o;for(let[o,l]of Object.entries(s.body)){if(Array.isArray(l)){if(l.some(S=>typeof S=="object"&&S!==null&&!C(S)))d.append(o,JSON.stringify(l));else for(let S=0;S<l.length;S++){let $=l[S],G=await h($);d.append(o,G)}continue}if(J){if(Array.isArray(l))for(let A of l)d.append(o,await h(A));else d.append(o,await h(l));continue}if(l instanceof File){d.append(o,await K(l));continue}if(l instanceof FileList){for(let A=0;A<l.length;A++)d.append(o,await K(l[A]));continue}d.append(o,await h(l))}s.body=d}else typeof a=="object"?(s.headers["content-type"]="application/json",s.body=JSON.stringify(a)):a!=null&&(s.headers["content-type"]="text/plain");if(v&&delete s.body,w){Array.isArray(w)||(w=[w]);for(let d of w){let c=await d(m,s);typeof c=="object"&&(s={...s,...c,headers:{...s.headers,...await E(c.headers,m,s)}})}}y?.headers?.["content-type"]&&(s.headers["content-type"]=y?.headers["content-type"]);let p=e+m+N,f;try{f=await(r?.handle(new Request(p,s))??H(p,s))}catch(d){return{data:null,error:new k(503,d),response:void 0,status:503,headers:void 0}}let g=null,j=null;if(O){Array.isArray(O)||(O=[O]);for(let d of O)try{let c=await d(f.clone());if(c!=null){g=c;break}}catch(c){c instanceof k?j=c:j=new k(422,c);break}}if(g!==null)return{data:g,error:j,response:f,status:f.status,headers:f.headers};switch(f.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":g=_(f);break;case"application/json":g=JSON.parse(await f.text(),(c,h)=>{if(typeof h!="string")return h;let o=T(h);return o||h});break;case"application/octet-stream":g=await f.arrayBuffer();break;case"multipart/form-data":let d=await f.formData();g={},d.forEach((c,h)=>{g[h]=c});break;default:g=await f.text().then(W)}return(f.status>=300||f.status<200)&&(j=new k(f.status,g),g=null),{data:g,error:j,response:f,status:f.status,headers:f.headers}})()}return typeof a=="object"?F(e,t,[...n,Object.values(a)[0]],r):F(e,t,n)}}),fe=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(V.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),F(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),F("http://e.ly",t,[],e));return ee(ue);})();
+`))!==-1;){let n=e.value.slice(0,t);if(e.value=e.value.slice(t+2),n.trim()){let s=V(n);s&&(yield s)}}}async function*_(e){let t=e.body;if(!t)return;let n=t.getReader(),s=new TextDecoder("utf-8"),r={value:""};try{for(;;){let{done:a,value:o}=await n.read();if(a)break;let f=typeof o=="string"?o:s.decode(o,{stream:!0});r.value+=f,yield*H(r)}let i=s.decode();if(i&&(r.value+=i),yield*H(r),r.value.trim()){let a=V(r.value);a&&(yield a)}}finally{n.releaseLock()}}var D=(e,t,n=[],s)=>new Proxy(()=>{},{get(r,i){return D(e,t,i==="index"?n:[...n,i],s)},apply(r,i,[a,o]){if(!a||o||typeof a=="object"&&Object.keys(a).length!==1||ae.includes(n.at(-1))){let f=[...n],u=f.pop(),p="/"+f.join("/"),{fetcher:N=fetch,headers:F,onRequest:b,onResponse:O,fetch:U}=t,$=u==="get"||u==="head"||u==="subscribe",I=$?a?.query:o?.query,L="";if(I){let c=(v,w)=>{L+=(L?"&":"?")+`${encodeURIComponent(v)}=${encodeURIComponent(w)}`};for(let[v,w]of Object.entries(I)){if(Array.isArray(w)){for(let y of w)c(v,y);continue}if(w!=null){if(typeof w=="object"){c(v,JSON.stringify(w));continue}c(v,`${w}`)}}}if(u==="subscribe"){let c=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||P.find(v=>e.includes(v))?"ws://":"wss://")+p+L;return new M(c)}return(async()=>{F=await E(F,p,o);let c={method:u?.toUpperCase(),body:a,...U,headers:F};c.headers={...F,...await E($?a?.headers:o?.headers,p,c)};let v=$&&typeof a=="object"?a.fetch:o?.fetch;if(c={...c,...v},$&&delete c.body,b){Array.isArray(b)||(b=[b]);for(let d of b){let l=await d(p,c);typeof l=="object"&&(c={...c,...l,headers:{...c.headers,...await E(l.headers,p,c)}})}}if($&&delete c.body,A(a)){let d=new FormData,l=B(c.body);for(let[h,g]of Object.entries(l))if(Array.isArray(g))for(let S of g)S instanceof File?d.append(h,R?S:await C(S)):m(S)&&d.append(h,S);else if(g instanceof File)d.append(h,R?g:await C(g));else if(!R&&g instanceof FileList)for(let S=0;S<g.length;S++)d.append(h,await C(g[S]));else m(g),d.append(h,g);c.body=d}else typeof a=="object"?(c.headers["content-type"]="application/json",c.body=JSON.stringify(a)):a!=null&&(c.headers["content-type"]="text/plain");if($&&delete c.body,b){Array.isArray(b)||(b=[b]);for(let d of b){let l=await d(p,c);typeof l=="object"&&(c={...c,...l,headers:{...c.headers,...await E(l.headers,p,c)}})}}o?.headers?.["content-type"]&&(c.headers["content-type"]=o?.headers["content-type"]);let w=e+p+L,y;try{y=await(s?.handle(new Request(w,c))??N(w,c))}catch(d){return{data:null,error:new j(503,d),response:void 0,status:503,headers:void 0}}let k=null,x=null;if(O){Array.isArray(O)||(O=[O]);for(let d of O)try{let l=await d(y.clone());if(l!=null){k=l;break}}catch(l){l instanceof j?x=l:x=new j(422,l);break}}if(k!==null)return{data:k,error:x,response:y,status:y.status,headers:y.headers};switch(y.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":k=_(y);break;case"application/json":k=JSON.parse(await y.text(),(l,h)=>{if(typeof h!="string")return h;let g=T(h);return g||h});break;case"application/octet-stream":k=await y.arrayBuffer();break;case"multipart/form-data":let d=await y.formData();k={},d.forEach((l,h)=>{k[h]=l});break;default:k=await y.text().then(W)}return(y.status>=300||y.status<200)&&(x=new j(y.status,k),k=null),{data:k,error:x,response:y,status:y.status,headers:y.headers}})()}return typeof a=="object"?D(e,t,[...n,Object.values(a)[0]],s):D(e,t,n)}}),oe=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(P.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),D(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),D("http://e.ly",t,[],e));return Y(ce);})();
diff --git a/dist/treaty2.js b/dist/treaty2.js
index 873abf5f9fee372739ae88cc6af8dd48740354a3..8ba7d76d6d982d9c34fe21eadcf432d08bfcc0f6 100644
--- a/dist/treaty2.js
+++ b/dist/treaty2.js
@@ -1,4 +1,4 @@
-"use strict";var D=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var Q=Object.prototype.hasOwnProperty;var X=(e,t)=>{for(var n in t)D(e,n,{get:t[n],enumerable:!0})},Y=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of z(t))!Q.call(e,i)&&i!==n&&D(e,i,{get:()=>t[i],enumerable:!(r=Z(t,i))||r.enumerable});return e};var ee=e=>Y(D({},"__esModule",{value:!0}),e);var ue={};X(ue,{streamResponse:()=>_,treaty:()=>fe});module.exports=ee(ue);var k=class extends Error{constructor(n,r){super(r+"");this.status=n;this.value=r}};var te=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,ne=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,re=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,se=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),T=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(te.test(t)||ne.test(t)||re.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},ie=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},ae=e=>JSON.parse(e,(t,n)=>{let r=T(n);return r||n}),W=e=>{if(!e)return e;if(se(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=T(e);if(t)return t;if(ie(e))try{return ae(e)}catch{}return e},q=e=>{let t=e.data.toString();return t==="null"?null:W(t)};var M=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,r){return this.addEventListener(t,n,r)}off(t,n,r){return this.ws.removeEventListener(t,n,r),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,r){return this.ws.addEventListener(t,i=>{if(t==="message"){let u=q(i);n({...i,data:u})}else n(i)},r),this}removeEventListener(t,n,r){return this.off(t,n,r),this}close(){return this.ws.close(),this}};var oe=["get","post","put","delete","patch","options","head","connect","subscribe"],V=["localhost","127.0.0.1","0.0.0.0"],J=typeof FileList>"u",C=e=>J?e instanceof Blob:e instanceof FileList||e instanceof File,ce=e=>{if(!e)return!1;for(let t in e)if(C(e[t])||Array.isArray(e[t])&&e[t].find(C))return!0;return!1},K=e=>J?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let r=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(r)},n.readAsArrayBuffer(e)}),E=async(e,t,n={},r={})=>{if(Array.isArray(e)){for(let i of e)if(!Array.isArray(i))r=await E(i,t,n,r);else{let u=i[0];if(typeof u=="string")r[u.toLowerCase()]=i[1];else for(let[a,y]of u)r[a.toLowerCase()]=y}return r}if(!e)return r;switch(typeof e){case"function":if(e instanceof Headers)return E(e,t,n,r);let i=await e(t,n);return i?E(i,t,n,r):r;case"object":if(e instanceof Headers)return e.forEach((u,a)=>{r[a.toLowerCase()]=u}),r;for(let[u,a]of Object.entries(e))r[u.toLowerCase()]=a;return r;default:return r}};function B(e){let t=e.split(`
-`),n={};for(let r of t){if(!r||r.startsWith(":"))continue;let i=r.indexOf(":");if(i>0){let u=r.slice(0,i).trim(),a=r.slice(i+1).replace(/^ /,"");n[u]=a&&W(a)}}return Object.keys(n).length>0?n:null}function*P(e){let t;for(;(t=e.value.indexOf(`
+"use strict";var K=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var z=Object.prototype.hasOwnProperty;var Q=(e,t)=>{for(var n in t)K(e,n,{get:t[n],enumerable:!0})},X=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Z(t))!z.call(e,r)&&r!==n&&K(e,r,{get:()=>t[r],enumerable:!(s=G(t,r))||s.enumerable});return e};var Y=e=>X(K({},"__esModule",{value:!0}),e);var ce={};Q(ce,{streamResponse:()=>_,treaty:()=>oe});module.exports=Y(ce);var j=class extends Error{constructor(n,s){super(s+"");this.status=n;this.value=s}};var ee=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,te=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,ne=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,se=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),T=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(ee.test(t)||te.test(t)||ne.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},re=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},ie=e=>JSON.parse(e,(t,n)=>{let s=T(n);return s||n}),W=e=>{if(!e)return e;if(se(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=T(e);if(t)return t;if(re(e))try{return ie(e)}catch{}return e},q=e=>{let t=e.data.toString();return t==="null"?null:W(t)};var M=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,s){return this.addEventListener(t,n,s)}off(t,n,s){return this.ws.removeEventListener(t,n,s),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,s){return this.ws.addEventListener(t,r=>{if(t==="message"){let i=q(r);n({...r,data:i})}else n(r)},s),this}removeEventListener(t,n,s){return this.off(t,n,s),this}close(){return this.ws.close(),this}};var ae=["get","post","put","delete","patch","options","head","connect","subscribe"],P=["localhost","127.0.0.1","0.0.0.0"],R=typeof FileList>"u",m=e=>R?e instanceof Blob:e instanceof FileList||e instanceof File,A=e=>{if(!e)return!1;for(let t in e){let n=e[t];if(m(n))return!0;if(Array.isArray(n)){for(let s of n)if(m(s)||typeof s=="object"&&s!==null&&A(s))return!0}else if(typeof n=="object"&&n!==null&&!(n instanceof Date)&&A(n))return!0}return!1},J=(e,t)=>{let n={},s=[];for(let[r,i]of Object.entries(e))if(m(i))s.push({key:`${t}.${r}`,value:i});else if(Array.isArray(i))if(i.some(o=>m(o)||typeof o=="object"&&o!==null&&A(o)))for(let o=0;o<i.length;o++){let f=i[o];if(m(f))s.push({key:`${t}.${r}[${o}]`,value:f});else if(typeof f=="object"&&f!==null&&A(f)){let u=J(f,`${t}.${r}[${o}]`);Object.keys(u.nonFileData).length>0&&s.push({key:`${t}.${r}[${o}]`,value:JSON.stringify(u.nonFileData)}),s.push(...u.files)}else typeof f=="object"&&f!==null?s.push({key:`${t}.${r}[${o}]`,value:JSON.stringify(f)}):s.push({key:`${t}.${r}[${o}]`,value:f})}else n[r]=i;else if(typeof i=="object"&&i!==null&&!(i instanceof Date))if(A(i)){let a=J(i,`${t}.${r}`);Object.keys(a.nonFileData).length>0&&(n[r]=a.nonFileData),s.push(...a.files)}else n[r]=i;else n[r]=i;return{nonFileData:n,files:s}},B=(e,t="")=>{let n={};for(let[s,r]of Object.entries(e)){let i=t?`${t}.${s}`:s;if(m(r))n[i]=r;else if(Array.isArray(r))if(r.some(o=>m(o)||typeof o=="object"&&o!==null&&A(o)))if(r.every(f=>m(f)))for(let f=0;f<r.length;f++)n[`${i}[${f}]`]=r[f];else for(let f=0;f<r.length;f++){let u=r[f],p=`${i}[${f}]`;if(m(u))n[p]=u;else if(typeof u=="object"&&u!==null&&!(u instanceof Date))if(A(u)){let{nonFileData:N,files:F}=J(u,p);Object.keys(N).length>0&&(n[p]=JSON.stringify(N));for(let{key:b,value:O}of F)n[b]=O}else n[p]=JSON.stringify(u);else n[p]=u}else n[i]=JSON.stringify(r);else typeof r=="object"&&r!==null&&!(r instanceof Date)?A(r)?Object.assign(n,B(r,i)):n[i]=JSON.stringify(r):n[i]=r}return n},C=e=>R?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let s=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(s)},n.readAsArrayBuffer(e)}),E=async(e,t,n={},s={})=>{if(Array.isArray(e)){for(let r of e)if(!Array.isArray(r))s=await E(r,t,n,s);else{let i=r[0];if(typeof i=="string")s[i.toLowerCase()]=r[1];else for(let[a,o]of i)s[a.toLowerCase()]=o}return s}if(!e)return s;switch(typeof e){case"function":if(e instanceof Headers)return E(e,t,n,s);let r=await e(t,n);return r?E(r,t,n,s):s;case"object":if(e instanceof Headers)return e.forEach((i,a)=>{s[a.toLowerCase()]=i}),s;for(let[i,a]of Object.entries(e))s[i.toLowerCase()]=a;return s;default:return s}};function V(e){let t=e.split(`
+`),n={};for(let s of t){if(!s||s.startsWith(":"))continue;let r=s.indexOf(":");if(r>0){let i=s.slice(0,r).trim(),a=s.slice(r+1).replace(/^ /,"");n[i]=a&&W(a)}}return Object.keys(n).length>0?n:null}function*H(e){let t;for(;(t=e.value.indexOf(`
 
-`))!==-1;){let n=e.value.slice(0,t);if(e.value=e.value.slice(t+2),n.trim()){let r=B(n);r&&(yield r)}}}async function*_(e){let t=e.body;if(!t)return;let n=t.getReader(),r=new TextDecoder("utf-8"),i={value:""};try{for(;;){let{done:a,value:y}=await n.read();if(a)break;let R=typeof y=="string"?y:r.decode(y,{stream:!0});i.value+=R,yield*P(i)}let u=r.decode();if(u&&(i.value+=u),yield*P(i),i.value.trim()){let a=B(i.value);a&&(yield a)}}finally{n.releaseLock()}}var F=(e,t,n=[],r)=>new Proxy(()=>{},{get(i,u){return F(e,t,u==="index"?n:[...n,u],r)},apply(i,u,[a,y]){if(!a||y||typeof a=="object"&&Object.keys(a).length!==1||oe.includes(n.at(-1))){let R=[...n],x=R.pop(),m="/"+R.join("/"),{fetcher:H=fetch,headers:L,onRequest:w,onResponse:O,fetch:U}=t,v=x==="get"||x==="head"||x==="subscribe",I=v?a?.query:y?.query,N="";if(I){let s=(b,p)=>{N+=(N?"&":"?")+`${encodeURIComponent(b)}=${encodeURIComponent(p)}`};for(let[b,p]of Object.entries(I)){if(Array.isArray(p)){for(let f of p)s(b,f);continue}if(p!=null){if(typeof p=="object"){s(b,JSON.stringify(p));continue}s(b,`${p}`)}}}if(x==="subscribe"){let s=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||V.find(b=>e.includes(b))?"ws://":"wss://")+m+N;return new M(s)}return(async()=>{L=await E(L,m,y);let s={method:x?.toUpperCase(),body:a,...U,headers:L};s.headers={...L,...await E(v?a?.headers:y?.headers,m,s)};let b=v&&typeof a=="object"?a.fetch:y?.fetch;if(s={...s,...b},v&&delete s.body,w){Array.isArray(w)||(w=[w]);for(let d of w){let c=await d(m,s);typeof c=="object"&&(s={...s,...c,headers:{...s.headers,...await E(c.headers,m,s)}})}}if(v&&delete s.body,ce(a)){let d=new FormData,c=o=>{if(typeof o=="string"||C(o))return!1;if(typeof o=="object"){if(o!==null)return!0;if(o instanceof Date)return!1}return!1},h=async o=>o instanceof File?await K(o):c(o)?JSON.stringify(o):o;for(let[o,l]of Object.entries(s.body)){if(Array.isArray(l)){if(l.some(S=>typeof S=="object"&&S!==null&&!C(S)))d.append(o,JSON.stringify(l));else for(let S=0;S<l.length;S++){let $=l[S],G=await h($);d.append(o,G)}continue}if(J){if(Array.isArray(l))for(let A of l)d.append(o,await h(A));else d.append(o,await h(l));continue}if(l instanceof File){d.append(o,await K(l));continue}if(l instanceof FileList){for(let A=0;A<l.length;A++)d.append(o,await K(l[A]));continue}d.append(o,await h(l))}s.body=d}else typeof a=="object"?(s.headers["content-type"]="application/json",s.body=JSON.stringify(a)):a!=null&&(s.headers["content-type"]="text/plain");if(v&&delete s.body,w){Array.isArray(w)||(w=[w]);for(let d of w){let c=await d(m,s);typeof c=="object"&&(s={...s,...c,headers:{...s.headers,...await E(c.headers,m,s)}})}}y?.headers?.["content-type"]&&(s.headers["content-type"]=y?.headers["content-type"]);let p=e+m+N,f;try{f=await(r?.handle(new Request(p,s))??H(p,s))}catch(d){return{data:null,error:new k(503,d),response:void 0,status:503,headers:void 0}}let g=null,j=null;if(O){Array.isArray(O)||(O=[O]);for(let d of O)try{let c=await d(f.clone());if(c!=null){g=c;break}}catch(c){c instanceof k?j=c:j=new k(422,c);break}}if(g!==null)return{data:g,error:j,response:f,status:f.status,headers:f.headers};switch(f.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":g=_(f);break;case"application/json":g=JSON.parse(await f.text(),(c,h)=>{if(typeof h!="string")return h;let o=T(h);return o||h});break;case"application/octet-stream":g=await f.arrayBuffer();break;case"multipart/form-data":let d=await f.formData();g={},d.forEach((c,h)=>{g[h]=c});break;default:g=await f.text().then(W)}return(f.status>=300||f.status<200)&&(j=new k(f.status,g),g=null),{data:g,error:j,response:f,status:f.status,headers:f.headers}})()}return typeof a=="object"?F(e,t,[...n,Object.values(a)[0]],r):F(e,t,n)}}),fe=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(V.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),F(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),F("http://e.ly",t,[],e));0&&(module.exports={streamResponse,treaty});
+`))!==-1;){let n=e.value.slice(0,t);if(e.value=e.value.slice(t+2),n.trim()){let s=V(n);s&&(yield s)}}}async function*_(e){let t=e.body;if(!t)return;let n=t.getReader(),s=new TextDecoder("utf-8"),r={value:""};try{for(;;){let{done:a,value:o}=await n.read();if(a)break;let f=typeof o=="string"?o:s.decode(o,{stream:!0});r.value+=f,yield*H(r)}let i=s.decode();if(i&&(r.value+=i),yield*H(r),r.value.trim()){let a=V(r.value);a&&(yield a)}}finally{n.releaseLock()}}var D=(e,t,n=[],s)=>new Proxy(()=>{},{get(r,i){return D(e,t,i==="index"?n:[...n,i],s)},apply(r,i,[a,o]){if(!a||o||typeof a=="object"&&Object.keys(a).length!==1||ae.includes(n.at(-1))){let f=[...n],u=f.pop(),p="/"+f.join("/"),{fetcher:N=fetch,headers:F,onRequest:b,onResponse:O,fetch:U}=t,$=u==="get"||u==="head"||u==="subscribe",I=$?a?.query:o?.query,L="";if(I){let c=(v,w)=>{L+=(L?"&":"?")+`${encodeURIComponent(v)}=${encodeURIComponent(w)}`};for(let[v,w]of Object.entries(I)){if(Array.isArray(w)){for(let y of w)c(v,y);continue}if(w!=null){if(typeof w=="object"){c(v,JSON.stringify(w));continue}c(v,`${w}`)}}}if(u==="subscribe"){let c=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||P.find(v=>e.includes(v))?"ws://":"wss://")+p+L;return new M(c)}return(async()=>{F=await E(F,p,o);let c={method:u?.toUpperCase(),body:a,...U,headers:F};c.headers={...F,...await E($?a?.headers:o?.headers,p,c)};let v=$&&typeof a=="object"?a.fetch:o?.fetch;if(c={...c,...v},$&&delete c.body,b){Array.isArray(b)||(b=[b]);for(let d of b){let l=await d(p,c);typeof l=="object"&&(c={...c,...l,headers:{...c.headers,...await E(l.headers,p,c)}})}}if($&&delete c.body,A(a)){let d=new FormData,l=B(c.body);for(let[h,g]of Object.entries(l))if(Array.isArray(g))for(let S of g)S instanceof File?d.append(h,R?S:await C(S)):m(S)&&d.append(h,S);else if(g instanceof File)d.append(h,R?g:await C(g));else if(!R&&g instanceof FileList)for(let S=0;S<g.length;S++)d.append(h,await C(g[S]));else m(g),d.append(h,g);c.body=d}else typeof a=="object"?(c.headers["content-type"]="application/json",c.body=JSON.stringify(a)):a!=null&&(c.headers["content-type"]="text/plain");if($&&delete c.body,b){Array.isArray(b)||(b=[b]);for(let d of b){let l=await d(p,c);typeof l=="object"&&(c={...c,...l,headers:{...c.headers,...await E(l.headers,p,c)}})}}o?.headers?.["content-type"]&&(c.headers["content-type"]=o?.headers["content-type"]);let w=e+p+L,y;try{y=await(s?.handle(new Request(w,c))??N(w,c))}catch(d){return{data:null,error:new j(503,d),response:void 0,status:503,headers:void 0}}let k=null,x=null;if(O){Array.isArray(O)||(O=[O]);for(let d of O)try{let l=await d(y.clone());if(l!=null){k=l;break}}catch(l){l instanceof j?x=l:x=new j(422,l);break}}if(k!==null)return{data:k,error:x,response:y,status:y.status,headers:y.headers};switch(y.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":k=_(y);break;case"application/json":k=JSON.parse(await y.text(),(l,h)=>{if(typeof h!="string")return h;let g=T(h);return g||h});break;case"application/octet-stream":k=await y.arrayBuffer();break;case"multipart/form-data":let d=await y.formData();k={},d.forEach((l,h)=>{k[h]=l});break;default:k=await y.text().then(W)}return(y.status>=300||y.status<200)&&(x=new j(y.status,k),k=null),{data:k,error:x,response:y,status:y.status,headers:y.headers}})()}return typeof a=="object"?D(e,t,[...n,Object.values(a)[0]],s):D(e,t,n)}}),oe=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(P.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),D(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),D("http://e.ly",t,[],e));0&&(module.exports={streamResponse,treaty});
diff --git a/dist/treaty2.mjs b/dist/treaty2.mjs
index e7838b4a83980d720a4f9eab03aa4ea4607523b8..f80be799202b5b44bf8e6ee92a73d9903ff68c28 100644
--- a/dist/treaty2.mjs
+++ b/dist/treaty2.mjs
@@ -1 +1 @@
-import{a,b}from"./chunk-7WR4DS5F.mjs";import"./chunk-QSLHAOSM.mjs";export{a as streamResponse,b as treaty};
+import{a,b}from"./chunk-3RD5JO62.mjs";import"./chunk-QSLHAOSM.mjs";export{a as streamResponse,b as treaty};
